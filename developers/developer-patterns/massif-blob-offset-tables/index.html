<!doctype html><html lang=en-GB><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=Strict-Transport-Security content="max-age=31536000; includeSubDomains"><meta http-equiv=X-Frame-Options content="SAMEORIGIN"><meta http-equiv=X-Content-Type-Options content="nosniff"><meta http-equiv=Referrer-Policy content="no-referrer-when-downgrade"><meta http-equiv=Content-Security-Policy content="style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net/npm/mermaid/dist/; script-src 'self' 'sha256-GoUI0hA42/W90nTDE3+8IM59Pmj5d7MTNu1m0Qv4C+o=' 'sha256-eg7hiIPJDJy7WtCOgK4mlnMdUDYpX6h90ef9pORicds=' https://cdn.jsdelivr.net/npm/mermaid/dist/ https://www.googletagmanager.com/gtag/js js.hs-scripts.com https://js.hscollectedforms.net/collectedforms.js js.hs-analytics.net https://js.usemessages.com/conversations-embed.js https://js.hsadspixel.net/fb.js js.hs-banner.com https://www.google-analytics.com/analytics.js googleads.g.doubleclick.net;"><link rel=preload as=font href=https://docs.datatrails.ai/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://docs.datatrails.ai/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://docs.datatrails.ai/main.c6d014fb8c7ce54b3fa20c1de175b7712c762183e7469e4ce8756d34cbfa5a47a7ce249bae032414f62dbc50462dae57544f3eb01f9efdae84161628644e70f9.css integrity="sha512-xtAU+4x85Us/ogwd4XW3cSx2IYPnRp5M6HVtNMv6WkenziSbrgMkFPYtvFBGLa5XVE8+sB+e/a6EFhYoZE5w+Q==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Massif blob pre-calculated offsets - DataTrails</title>
<meta name=description content="Provides pre calculated tables for navigating raw Merkle logs"><link rel=canonical href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/RKVST_WhtLogo_CMYK.svg"><meta name=twitter:title content="Massif blob pre-calculated offsets"><meta name=twitter:description content="Provides pre calculated tables for navigating raw Merkle logs"><meta name=twitter:site content="@"><meta name=twitter:creator content="@"><meta property="og:title" content="Massif blob pre-calculated offsets"><meta property="og:description" content="Provides pre calculated tables for navigating raw Merkle logs"><meta property="og:type" content="article"><meta property="og:url" content="/developers/developer-patterns/massif-blob-offset-tables/"><meta property="og:image" content="/RKVST_WhtLogo_CMYK.svg"><meta property="og:site_name" content="DataTrails"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/docs.datatrails.ai\/"},{"@type":"ListItem","position":3,"name":"Developers","item":"https:\/\/docs.datatrails.ai\/\/developers\/"},{"@type":"ListItem","position":4,"name":"Developer Patterns","item":"https:\/\/docs.datatrails.ai\/\/developers\/developer-patterns\/"},{"@type":"ListItem","position":5,"name":"Massif Blob Offset Tables","item":"https:\/\/docs.datatrails.ai\/\/developers\/developer-patterns\/massif-blob-offset-tables\/"}]}</script><meta name=theme-color content="#fff"><link rel=icon type=image/png sizes=32x32 href=https://docs.datatrails.ai/DataTrails_Favicon_32x32.png><link rel=icon type=image/png sizes=16x16 href=https://docs.datatrails.ai/DataTrails_Favicon_16x16.png><link rel=manifest href=https://docs.datatrails.ai/site.webmanifest><script type=text/javascript id=hs-script-loader async defer src=//js.hs-scripts.com/9491266.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-7K46H3KK7N"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-7K46H3KK7N")</script></head><body class="developers single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label>
<a class="navbar-brand order-1 order-md-0 me-auto" style=font-family:Montserrat href=https://www.datatrails.ai>DataTrails</a>
<button id=mode class="btn btn-link order-2 order-md-3" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav main-nav me-auto order-6 order-md-3" style=white-space:nowrap><a href=https://app.datatrails.ai/login target=_blank rel="noopener noreferrer" class="btn btn-link" style=margin-left:20px;font-size:18px role=button>Sign In</a>
<a href=https://app.datatrails.ai/signup target=_blank rel="noopener noreferrer" class="btn btn-primary btn-xs" style=margin-left:10px;font-size:18px;padding-top:9px role=button>Sign Up</a></ul></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2" style=white-space:nowrap><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/>Home</a></li><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/developers/developer-patterns/getting-access-tokens-using-app-registrations/>Developers</a></li><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/platform/overview/core-concepts/>Platform</a></li><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/usecases/authenticity-and-attestation/>Use Cases</a></li><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/glossary/common-datatrails-terms/>Glossary</a></li><li class=nav-item><a class=nav-link href=https://support.datatrails.ai>Support</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#developer-patterns aria-expanded=true>
Developer Patterns</button><div class="collapse show" id=developer-patterns><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/getting-access-tokens-using-app-registrations/>Creating Access Tokens Using a Custom Integration</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/namespace/>Namespace</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/document-profile/>Document Profile</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/software-package-profile/>Software Package Profile</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/veracity/>Independently verifying DataTrails transparent merkle logs</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/>Navigating the Merkle Log</a></li><li><a class="docs-link rounded active" href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables/>Massif blob pre-calculated offsets</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/>Verified Replication of the Datatrails Transparency Logs</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/scitt-api/>Quickstart: SCITT Statements (Preview)</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#templates aria-expanded=false>
templates</button><div class=collapse id=templates><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/templates/scitt/>SCITT vCon Template</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/templates/vcons/>DataTrails Event vCon Template</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#integrations aria-expanded=false>
integrations</button><div class=collapse id=integrations><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/integrations/n8n/>Integrating with n8n</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#api-reference aria-expanded=false>
API Reference</button><div class=collapse id=api-reference><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/app-registrations-api/>App Registrations API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/assets-api/>Assets API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/asset-events-api/>Asset-Events API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/attachments-api/>Attachments API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/blobs-api/>Blobs API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/compliance-api/>Compliance API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/events-api/>Events API (preview)</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/iam-policies-api/>IAM Policies API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/iam-subjects-api/>IAM Subjects API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/locations-api/>Locations API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/members-api/>Members API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/public-assets-api/>Public Assets API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/tenancies-api/>Tenancies API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/caps-api/>Caps API</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#yaml-reference aria-expanded=false>
YAML Runner Reference</button><div class=collapse id=yaml-reference><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/story-runner-components/>YAML Runner Components</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/assets/>Assets YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/events/>Events YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/locations/>Locations YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/subjects/>Subjects YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/compliance/>Compliance Policies YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/estate-info/>Estate Information YAML Runner</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#each-log-is-comprised-of-many-blobs-each-containing-a-fixed-number-of-leaves>Each Log Is Comprised of Many Blobs, Each Containing a Fixed Number of Leaves</a></li><li><a href=#each-individual-blob-has-a-fixed-size-portion-and-two-variably-sized-sections>Each Individual Blob Has a Fixed Size Portion and Two Variably Sized Sections</a></li><li><a href=#the-peak-stack-and-mmr-data-sizes-are-computable>The Peak Stack and MMR Data Sizes Are Computable</a></li><li><a href=#pre-computes-for-your-first-million-events>Pre-computes for Your First Million Events</a></li><li><a href=#the-algorithms-backing-the-table-generation>The Algorithms Backing the Table Generation</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://docs.datatrails.ai/>Home</a></li><li class=breadcrumb-item><a href=https://docs.datatrails.ai/developers/>Developers</a></li><li class=breadcrumb-item><a href=https://docs.datatrails.ai/developers/developer-patterns/>Developer Patterns</a></li><li class="breadcrumb-item active" aria-current=page>Massif blob pre-calculated offsets</li></ol></nav><div class=my-n3></div><h1>Massif blob pre-calculated offsets</h1><p class=lead>Lookup tables for navigating the dynamic, but computable, offsets into the Merkle log binary format</p><p>This page provides lookup tables for navigating the dynamic, but computable, offsets into the Merkle log binary format.
The algorithms to reproduce this are relatively simple.
DataTrails provides
<a href=https://github.com/datatrails/veracity/ target=_blank rel=noopener>open-source implementations</a>, but in many contexts it is simpler to use these pre-calculations.
These tables can be made for any log configuration at any time, in part or in whole, without access to any specific log.</p><p>This is a quick review of the log format.
We explain this in more detail at
<a href=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs>Navigating the Merkle Log</a></p><h2 id=each-log-is-comprised-of-many-blobs-each-containing-a-fixed-number-of-leaves>Each Log Is Comprised of Many Blobs, Each Containing a Fixed Number of Leaves<a href=#each-log-is-comprised-of-many-blobs-each-containing-a-fixed-number-of-leaves class=anchor aria-hidden=true>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    +----------+ +----------+ .. +----------+
</span></span><span class=line><span class=cl>    | massif 0 | | massif 1 |    | massif n
</span></span><span class=line><span class=cl>    +----------+ +----------+ .. +----------+
</span></span></code></pre></div><p>New leaves are added to the last blob in the log.</p><h2 id=each-individual-blob-has-a-fixed-size-portion-and-two-variably-sized-sections>Each Individual Blob Has a Fixed Size Portion and Two Variably Sized Sections<a href=#each-individual-blob-has-a-fixed-size-portion-and-two-variably-sized-sections class=anchor aria-hidden=true>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    |--------.----------.----------.---------|
</span></span><span class=line><span class=cl>    |  fixed  size      | computable size    |
</span></span><span class=line><span class=cl>    |--------.----------.----------.---------|
</span></span><span class=line><span class=cl>    | header | trieData |peak stack| mmrData |
</span></span><span class=line><span class=cl>    |--------.----------.----------.---------|
</span></span></code></pre></div><h2 id=the-peak-stack-and-mmr-data-sizes-are-computable>The Peak Stack and MMR Data Sizes Are Computable<a href=#the-peak-stack-and-mmr-data-sizes-are-computable class=anchor aria-hidden=true>#</a></h2><p>&mldr;but it is not always convenient to do so.</p><p>Using <code>veracity</code>, the following command line can reproduce a canonical &ldquo;illustrative&rdquo; log from
<a href=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs>Navigating the Merkle Log</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>veracity --height <span class=m>2</span> massifs --count <span class=m>6</span>
</span></span></code></pre></div><p>generates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>                       14
</span></span><span class=line><span class=cl>                          \
</span></span><span class=line><span class=cl>                6           13             21
</span></span><span class=line><span class=cl>                  \            \              \
</span></span><span class=line><span class=cl>    h=2 1 |  2  |  5  |   9  |  12   |  17   | 20  |
</span></span><span class=line><span class=cl>          |     |     |      |       |       |     |
</span></span><span class=line><span class=cl>        0 |0   1| 3  4| 7   8|10   11|15   16|18 19| MMR INDICES
</span></span><span class=line><span class=cl>        0 |0   1| 2  3| 4   5|6     7|8     9|10 11| LEAF INDICES
</span></span></code></pre></div><p>The following table <em>Stack Start</em> and <em>mmr Start</em> are byte offsets from the start of the file.
<em>Stack Start</em> is the end of the fixed header information, the relevant parts of which are described in
<a href=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs>Navigating the Merkle Log</a>.</p><p>The leaf values are indices into the trie fields (not considered further in this page) and the node values are indices into the array of 32-byte nodes starting at <em>mmr Start</em></p><table><thead><tr><th>Massif</th><th>Stack Start</th><th>mmr Start</th><th>First leaf</th><th>Last Leaf</th><th>First Node</th><th>Last Node</th><th>Peak Stack</th></tr></thead><tbody><tr><td>0</td><td>544</td><td>544</td><td>0</td><td>1</td><td>0</td><td>2</td><td>[]</td></tr><tr><td>1</td><td>544</td><td>576</td><td>2</td><td>3</td><td>3</td><td>6</td><td>[2]</td></tr><tr><td>2</td><td>544</td><td>576</td><td>4</td><td>5</td><td>7</td><td>9</td><td>[6]</td></tr><tr><td>3</td><td>544</td><td>608</td><td>6</td><td>7</td><td>10</td><td>14</td><td>[6,9]</td></tr><tr><td>4</td><td>544</td><td>576</td><td>8</td><td>9</td><td>15</td><td>17</td><td>[14]</td></tr><tr><td>5</td><td>544</td><td>608</td><td>10</td><td>11</td><td>18</td><td>21</td><td>[14,17]</td></tr></tbody></table><p>It is fairly easy to validate the leaves and nodes by hand.
Reproducing the Stack Start needs details from
<a href=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs>Navigating the Merkle Log</a>.</p><h2 id=pre-computes-for-your-first-million-events>Pre-computes for Your First Million Events<a href=#pre-computes-for-your-first-million-events class=anchor aria-hidden=true>#</a></h2><p>DataTrails production logs currently have a massif height of 14, which is results in 8192 leaves, which is $$1^{14-1}$$</p><table><thead><tr><th>Massif</th><th>Stack Start</th><th>mmr Start</th><th>First leaf</th><th>Last Leaf</th><th>First Node</th><th>Last Node</th><th>Peak Stack</th></tr></thead><tbody><tr><td>0</td><td>1048864</td><td>1048864</td><td>0</td><td>8191</td><td>0</td><td>16382</td><td>[]</td></tr><tr><td>1</td><td>1048864</td><td>1048896</td><td>8192</td><td>16383</td><td>16383</td><td>32766</td><td>[16382]</td></tr><tr><td>2</td><td>1048864</td><td>1048896</td><td>16384</td><td>24575</td><td>32767</td><td>49149</td><td>[32766]</td></tr><tr><td>3</td><td>1048864</td><td>1048928</td><td>24576</td><td>32767</td><td>49150</td><td>65534</td><td>[32766,49149]</td></tr><tr><td>4</td><td>1048864</td><td>1048896</td><td>32768</td><td>40959</td><td>65535</td><td>81917</td><td>[65534]</td></tr><tr><td>5</td><td>1048864</td><td>1048928</td><td>40960</td><td>49151</td><td>81918</td><td>98301</td><td>[65534,81917]</td></tr><tr><td>6</td><td>1048864</td><td>1048928</td><td>49152</td><td>57343</td><td>98302</td><td>114684</td><td>[65534,98301]</td></tr><tr><td>7</td><td>1048864</td><td>1048960</td><td>57344</td><td>65535</td><td>114685</td><td>131070</td><td>[65534,98301,114684]</td></tr><tr><td>8</td><td>1048864</td><td>1048896</td><td>65536</td><td>73727</td><td>131071</td><td>147453</td><td>[131070]</td></tr><tr><td>9</td><td>1048864</td><td>1048928</td><td>73728</td><td>81919</td><td>147454</td><td>163837</td><td>[131070,147453]</td></tr><tr><td>10</td><td>1048864</td><td>1048928</td><td>81920</td><td>90111</td><td>163838</td><td>180220</td><td>[131070,163837]</td></tr><tr><td>11</td><td>1048864</td><td>1048960</td><td>90112</td><td>98303</td><td>180221</td><td>196605</td><td>[131070,163837,180220]</td></tr><tr><td>12</td><td>1048864</td><td>1048928</td><td>98304</td><td>106495</td><td>196606</td><td>212988</td><td>[131070,196605]</td></tr><tr><td>13</td><td>1048864</td><td>1048960</td><td>106496</td><td>114687</td><td>212989</td><td>229372</td><td>[131070,196605,212988]</td></tr><tr><td>14</td><td>1048864</td><td>1048960</td><td>114688</td><td>122879</td><td>229373</td><td>245755</td><td>[131070,196605,229372]</td></tr><tr><td>15</td><td>1048864</td><td>1048992</td><td>122880</td><td>131071</td><td>245756</td><td>262142</td><td>[131070,196605,229372,245755]</td></tr><tr><td>16</td><td>1048864</td><td>1048896</td><td>131072</td><td>139263</td><td>262143</td><td>278525</td><td>[262142]</td></tr><tr><td>17</td><td>1048864</td><td>1048928</td><td>139264</td><td>147455</td><td>278526</td><td>294909</td><td>[262142,278525]</td></tr><tr><td>18</td><td>1048864</td><td>1048928</td><td>147456</td><td>155647</td><td>294910</td><td>311292</td><td>[262142,294909]</td></tr><tr><td>19</td><td>1048864</td><td>1048960</td><td>155648</td><td>163839</td><td>311293</td><td>327677</td><td>[262142,294909,311292]</td></tr><tr><td>20</td><td>1048864</td><td>1048928</td><td>163840</td><td>172031</td><td>327678</td><td>344060</td><td>[262142,327677]</td></tr><tr><td>21</td><td>1048864</td><td>1048960</td><td>172032</td><td>180223</td><td>344061</td><td>360444</td><td>[262142,327677,344060]</td></tr><tr><td>22</td><td>1048864</td><td>1048960</td><td>180224</td><td>188415</td><td>360445</td><td>376827</td><td>[262142,327677,360444]</td></tr><tr><td>23</td><td>1048864</td><td>1048992</td><td>188416</td><td>196607</td><td>376828</td><td>393213</td><td>[262142,327677,360444,376827]</td></tr><tr><td>24</td><td>1048864</td><td>1048928</td><td>196608</td><td>204799</td><td>393214</td><td>409596</td><td>[262142,393213]</td></tr><tr><td>25</td><td>1048864</td><td>1048960</td><td>204800</td><td>212991</td><td>409597</td><td>425980</td><td>[262142,393213,409596]</td></tr><tr><td>26</td><td>1048864</td><td>1048960</td><td>212992</td><td>221183</td><td>425981</td><td>442363</td><td>[262142,393213,425980]</td></tr><tr><td>27</td><td>1048864</td><td>1048992</td><td>221184</td><td>229375</td><td>442364</td><td>458748</td><td>[262142,393213,425980,442363]</td></tr><tr><td>28</td><td>1048864</td><td>1048960</td><td>229376</td><td>237567</td><td>458749</td><td>475131</td><td>[262142,393213,458748]</td></tr><tr><td>29</td><td>1048864</td><td>1048992</td><td>237568</td><td>245759</td><td>475132</td><td>491515</td><td>[262142,393213,458748,475131]</td></tr><tr><td>30</td><td>1048864</td><td>1048992</td><td>245760</td><td>253951</td><td>491516</td><td>507898</td><td>[262142,393213,458748,491515]</td></tr><tr><td>31</td><td>1048864</td><td>1049024</td><td>253952</td><td>262143</td><td>507899</td><td>524286</td><td>[262142,393213,458748,491515,507898]</td></tr><tr><td>32</td><td>1048864</td><td>1048896</td><td>262144</td><td>270335</td><td>524287</td><td>540669</td><td>[524286]</td></tr><tr><td>33</td><td>1048864</td><td>1048928</td><td>270336</td><td>278527</td><td>540670</td><td>557053</td><td>[524286,540669]</td></tr><tr><td>34</td><td>1048864</td><td>1048928</td><td>278528</td><td>286719</td><td>557054</td><td>573436</td><td>[524286,557053]</td></tr><tr><td>35</td><td>1048864</td><td>1048960</td><td>286720</td><td>294911</td><td>573437</td><td>589821</td><td>[524286,557053,573436]</td></tr><tr><td>36</td><td>1048864</td><td>1048928</td><td>294912</td><td>303103</td><td>589822</td><td>606204</td><td>[524286,589821]</td></tr><tr><td>37</td><td>1048864</td><td>1048960</td><td>303104</td><td>311295</td><td>606205</td><td>622588</td><td>[524286,589821,606204]</td></tr><tr><td>38</td><td>1048864</td><td>1048960</td><td>311296</td><td>319487</td><td>622589</td><td>638971</td><td>[524286,589821,622588]</td></tr><tr><td>39</td><td>1048864</td><td>1048992</td><td>319488</td><td>327679</td><td>638972</td><td>655357</td><td>[524286,589821,622588,638971]</td></tr><tr><td>40</td><td>1048864</td><td>1048928</td><td>327680</td><td>335871</td><td>655358</td><td>671740</td><td>[524286,655357]</td></tr><tr><td>41</td><td>1048864</td><td>1048960</td><td>335872</td><td>344063</td><td>671741</td><td>688124</td><td>[524286,655357,671740]</td></tr><tr><td>42</td><td>1048864</td><td>1048960</td><td>344064</td><td>352255</td><td>688125</td><td>704507</td><td>[524286,655357,688124]</td></tr><tr><td>43</td><td>1048864</td><td>1048992</td><td>352256</td><td>360447</td><td>704508</td><td>720892</td><td>[524286,655357,688124,704507]</td></tr><tr><td>44</td><td>1048864</td><td>1048960</td><td>360448</td><td>368639</td><td>720893</td><td>737275</td><td>[524286,655357,720892]</td></tr><tr><td>45</td><td>1048864</td><td>1048992</td><td>368640</td><td>376831</td><td>737276</td><td>753659</td><td>[524286,655357,720892,737275]</td></tr><tr><td>46</td><td>1048864</td><td>1048992</td><td>376832</td><td>385023</td><td>753660</td><td>770042</td><td>[524286,655357,720892,753659]</td></tr><tr><td>47</td><td>1048864</td><td>1049024</td><td>385024</td><td>393215</td><td>770043</td><td>786429</td><td>[524286,655357,720892,753659,770042]</td></tr><tr><td>48</td><td>1048864</td><td>1048928</td><td>393216</td><td>401407</td><td>786430</td><td>802812</td><td>[524286,786429]</td></tr><tr><td>49</td><td>1048864</td><td>1048960</td><td>401408</td><td>409599</td><td>802813</td><td>819196</td><td>[524286,786429,802812]</td></tr><tr><td>50</td><td>1048864</td><td>1048960</td><td>409600</td><td>417791</td><td>819197</td><td>835579</td><td>[524286,786429,819196]</td></tr><tr><td>51</td><td>1048864</td><td>1048992</td><td>417792</td><td>425983</td><td>835580</td><td>851964</td><td>[524286,786429,819196,835579]</td></tr><tr><td>52</td><td>1048864</td><td>1048960</td><td>425984</td><td>434175</td><td>851965</td><td>868347</td><td>[524286,786429,851964]</td></tr><tr><td>53</td><td>1048864</td><td>1048992</td><td>434176</td><td>442367</td><td>868348</td><td>884731</td><td>[524286,786429,851964,868347]</td></tr><tr><td>54</td><td>1048864</td><td>1048992</td><td>442368</td><td>450559</td><td>884732</td><td>901114</td><td>[524286,786429,851964,884731]</td></tr><tr><td>55</td><td>1048864</td><td>1049024</td><td>450560</td><td>458751</td><td>901115</td><td>917500</td><td>[524286,786429,851964,884731,901114]</td></tr><tr><td>56</td><td>1048864</td><td>1048960</td><td>458752</td><td>466943</td><td>917501</td><td>933883</td><td>[524286,786429,917500]</td></tr><tr><td>57</td><td>1048864</td><td>1048992</td><td>466944</td><td>475135</td><td>933884</td><td>950267</td><td>[524286,786429,917500,933883]</td></tr><tr><td>58</td><td>1048864</td><td>1048992</td><td>475136</td><td>483327</td><td>950268</td><td>966650</td><td>[524286,786429,917500,950267]</td></tr><tr><td>59</td><td>1048864</td><td>1049024</td><td>483328</td><td>491519</td><td>966651</td><td>983035</td><td>[524286,786429,917500,950267,966650]</td></tr><tr><td>60</td><td>1048864</td><td>1048992</td><td>491520</td><td>499711</td><td>983036</td><td>999418</td><td>[524286,786429,917500,983035]</td></tr><tr><td>61</td><td>1048864</td><td>1049024</td><td>499712</td><td>507903</td><td>999419</td><td>1015802</td><td>[524286,786429,917500,983035,999418]</td></tr></tbody></table><h2 id=the-algorithms-backing-the-table-generation>The Algorithms Backing the Table Generation<a href=#the-algorithms-backing-the-table-generation class=anchor aria-hidden=true>#</a></h2><p>In combination with the format information at
<a href=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs>Navigating the Merkle Log</a> the pre-computed tables above can be generated using these examples using the DataTrails open source, go-lang based
<a href=https://github.com/datatrails/veracity/ target=_blank rel=noopener>veracity</a> tooling.</p><ul class="nav nav-tabs" id=convert-idtimestamp role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#convert-idtimestamp-0 type=button role=tab aria-controls=convert-idtimestamp-0 aria-selected=true>Leaf Count and Massif Index</button></li><li class=nav-item><button data-bs-toggle=tab class=nav-link data-bs-target=#convert-idtimestamp-1 type=button role=tab aria-controls=convert-idtimestamp-1 aria-selected=false>mmrIndex from leafIndex</button></li><li class=nav-item><button data-bs-toggle=tab class=nav-link data-bs-target=#convert-idtimestamp-2 type=button role=tab aria-controls=convert-idtimestamp-2 aria-selected=false>Peak Stack Length</button></li></ul><div class=tab-content id=convert-idtimestamp><div id=convert-idtimestamp-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=convert-idtimestamp-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>massifIndex</span><span class=p>(</span><span class=nx>mmrIndex</span><span class=p>,</span> <span class=nx>massifHeight</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>nl</span> <span class=o>=</span>  <span class=nb>Number</span><span class=p>(</span><span class=nx>leafCount</span><span class=p>(</span><span class=nx>mmrIndex</span> <span class=o>+</span> <span class=mi>1</span><span class=nx>n</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>f</span> <span class=o>=</span> <span class=nb>Number</span><span class=p>(</span><span class=mi>1</span><span class=nx>n</span> <span class=o>&lt;&lt;</span> <span class=nx>massifHeight</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>massifIndex</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nx>nl</span> <span class=o>/</span> <span class=nx>f</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>massifIndex</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// returns the number of leaves in the largest mmr whose size is &lt;= the supplied size
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>leafCount</span><span class=p>(</span><span class=nx>mmrSize</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>pos</span> <span class=o>=</span> <span class=nx>BigInt</span><span class=p>(</span><span class=nx>mmrSize</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>pos</span> <span class=o>==</span> <span class=nx>BigInt</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span> <span class=k>return</span> <span class=mi>0</span><span class=nx>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>peakSize</span> <span class=o>=</span> <span class=p>((</span><span class=mi>1</span><span class=nx>n</span> <span class=o>&lt;&lt;</span> <span class=mi>64</span><span class=nx>n</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=nx>n</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=nx>BigInt</span><span class=p>(</span><span class=nx>clz64</span><span class=p>(</span><span class=nx>mmrSize</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>peakMap</span> <span class=o>=</span> <span class=mi>0</span><span class=nx>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(;</span> <span class=nx>peakSize</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=nx>n</span><span class=p>;)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>peakMap</span> <span class=o>&lt;&lt;=</span> <span class=mi>1</span><span class=nx>n</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>pos</span> <span class=o>&gt;=</span> <span class=nx>peakSize</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>pos</span> <span class=o>-=</span> <span class=nx>peakSize</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>peakMap</span> <span class=o>|=</span> <span class=mi>1</span><span class=nx>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>peakSize</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=nx>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>peakMap</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>clz64</span><span class=p>(</span><span class=nx>num</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=k>typeof</span> <span class=nx>num</span> <span class=o>===</span> <span class=s1>&#39;bigint&#39;</span><span class=p>)</span> <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=sb>`num must be bigint not </span><span class=si>${</span><span class=k>typeof</span> <span class=nx>num</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>num</span> <span class=o>=</span> <span class=nx>BigInt</span><span class=p>.</span><span class=nx>asUintN</span><span class=p>(</span><span class=mi>64</span><span class=p>,</span> <span class=nx>num</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>hi</span> <span class=o>=</span> <span class=nx>num</span> <span class=o>&gt;&gt;</span> <span class=mi>32</span><span class=nx>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>lz</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>clz32</span><span class=p>(</span><span class=nb>Number</span><span class=p>(</span><span class=nx>hi</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>lz</span> <span class=o>!==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span> <span class=nx>lz</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>lo</span> <span class=o>=</span> <span class=nb>Number</span><span class=p>((</span><span class=nx>num</span> <span class=o>&amp;</span> <span class=p>((</span><span class=mi>1</span><span class=nx>n</span> <span class=o>&lt;&lt;</span> <span class=mi>32</span><span class=nx>n</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=nx>n</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>32</span> <span class=o>+</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>clz32</span><span class=p>(</span><span class=nx>lo</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div><div id=convert-idtimestamp-1 class="tab-pane fade" role=tabpanel aria-labelledby=convert-idtimestamp-1><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>treeIndex</span><span class=p>(</span><span class=nx>iLeaf</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>sum</span> <span class=o>=</span> <span class=mi>0</span><span class=nx>n</span><span class=p>;</span> <span class=c1>// Assuming iLeaf can be very large, use BigInt for accuracy.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=nx>BigInt</span><span class=p>(</span><span class=nx>iLeaf</span><span class=p>);</span> <span class=c1>// Ensure iLeaf is treated as BigInt
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span><span class=nx>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>height</span> <span class=o>=</span> <span class=nx>log2Uint64</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=nx>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>sum</span> <span class=o>+=</span> <span class=nx>spurSumHeight</span><span class=p>(</span><span class=nx>height</span><span class=p>)</span> <span class=o>+</span> <span class=nx>BigInt</span><span class=p>(</span><span class=nx>height</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>half</span> <span class=o>=</span> <span class=mi>1</span><span class=nx>n</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=nx>height</span> <span class=o>-</span> <span class=mi>1</span><span class=nx>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>i</span> <span class=o>-=</span> <span class=nx>half</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>sum</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// spurSumHeight counts the interior &#39;spur&#39; nodes required for the given height
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>spurSumHeight</span><span class=p>(</span><span class=nx>height</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>height</span> <span class=o>=</span> <span class=nx>BigInt</span><span class=p>(</span><span class=nx>height</span><span class=p>);</span> <span class=c1>// Ensure height is treated as BigInt
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>height</span> <span class=o>===</span> <span class=nx>BigInt</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>BigInt</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>sum</span> <span class=o>=</span> <span class=nx>BigInt</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=nx>BigInt</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span> <span class=nx>i</span> <span class=o>&lt;=</span> <span class=nx>height</span> <span class=o>-</span> <span class=nx>BigInt</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span> <span class=nx>i</span> <span class=o>+=</span> <span class=nx>BigInt</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>sum</span> <span class=o>+=</span> <span class=p>(</span><span class=nx>BigInt</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=nx>height</span> <span class=o>-</span> <span class=nx>BigInt</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=o>-</span> <span class=nx>i</span><span class=p>))</span> <span class=o>*</span> <span class=nx>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>sum</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>log2Uint64</span><span class=p>(</span><span class=nx>num</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=k>typeof</span> <span class=nx>num</span> <span class=o>===</span> <span class=s1>&#39;bigint&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>num</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=nx>n</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=nx>n</span><span class=p>;</span> <span class=c1>// log2(1) = 0 and log2(0) is undefined, handled as 0 for simplicity
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kd>let</span> <span class=nx>log</span> <span class=o>=</span> <span class=mi>0</span><span class=nx>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=p>(</span><span class=nx>num</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>num</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=nx>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=nx>log</span> <span class=o>+=</span> <span class=mi>1</span><span class=nx>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>log</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>num</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// Similarly, handle log2(1) = 0 and log2(0) as 0
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>log2</span><span class=p>(</span><span class=nx>num</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div><div id=convert-idtimestamp-2 class="tab-pane fade" role=tabpanel aria-labelledby=convert-idtimestamp-2><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=cm>/** Calculate the size of a massifs peak stack by passing the massifIndex in place of iLeaf */</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>leafMinusSpurSum</span><span class=p>(</span><span class=nx>iLeaf</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>sum</span> <span class=o>=</span> <span class=nx>BigInt</span><span class=p>(</span><span class=nx>iLeaf</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>iLeaf</span> <span class=o>=</span> <span class=nx>sum</span> <span class=o>&gt;&gt;</span> <span class=nx>BigInt</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span><span class=nx>iLeaf</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>sum</span> <span class=o>-=</span> <span class=nx>iLeaf</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>iLeaf</span> <span class=o>&gt;&gt;=</span> <span class=nx>BigInt</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>sum</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div></div><p class=edit-page></p><div class="docs-navigation d-flex justify-content-between"><a href=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/><div class="card my-1"><div class="card-body py-2">&larr; Navigating the Merkle Log</div></div></a><a class=ms-auto href=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/><div class="card my-1"><div class="card-body py-2">Verified Replication of the Datatrails Transparency Logs &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div><div class="col-lg-8 order-first text-lg-end"><ul class=list-inline><li>Can't find what you're looking for? Search our <a href=https://support.datatrails.ai>Support Knowledgebase</a> or <a href=mailto:support@datatrails.ai>email Support</a></li></ul></div></div></div></footer><script src=https://docs.datatrails.ai/js/bootstrap.min.b4d48dd4d57c29a63a0ea5455b6d5b16f032e551e190ca88c04a0e5dd6b64b01657b3e1f44ff6e670ab72166686b0572f94c18d2f8d14c1a01aaf5f8e28fb345.js integrity="sha512-tNSN1NV8KaY6DqVFW21bFvAy5VHhkMqIwEoOXda2SwFlez4fRP9uZwq3IWZoawVy+UwY0vjRTBoBqvX44o+zRQ==" crossorigin=anonymous defer></script><script src=https://docs.datatrails.ai/js/highlight.min.9f2343bf41a83c327df632236d3b94b6e437d801529a03646f4322daedd07c0455162b232c7cf5bb1b1b7e0d6072ff0dac4ed8afc550127d165a9c482c3ec27c.js integrity="sha512-nyNDv0GoPDJ99jIjbTuUtuQ32AFSmgNkb0Mi2u3QfARVFisjLHz1uxsbfg1gcv8NrE7Yr8VQEn0WWpxILD7CfA==" crossorigin=anonymous defer></script><script src=https://docs.datatrails.ai/main.min.5a11cd173e56732b0a703e2f8ecf68ea541e5db0cfb67389769e34602825b7b2517cd5043ac8da49638c3e5edbeb2706e035cf5a1ab50f79ddff45ab24f6122c.js integrity="sha512-WhHNFz5WcysKcD4vjs9o6lQeXbDPtnOJdp40YCglt7JRfNUEOsjaSWOMPl7b6ycG4DXPWhq1D3nd/0WrJPYSLA==" crossorigin=anonymous defer></script><script src=https://docs.datatrails.ai/index.min.0bfa52b4ba2a9c744c49851d44d51ddc614dc3f6c0dd7f994fb8b9f79a2afddaf7da651cc52d4ab8b29f07cf4d15f41296b66625008db89f529207ac600cf187.js integrity="sha512-C/pStLoqnHRMSYUdRNUd3GFNw/bA3X+ZT7i595oq/dr32mUcxS1KuLKfB89NFfQSlrZmJQCNuJ9SkgesYAzxhw==" crossorigin=anonymous defer></script></body></html>