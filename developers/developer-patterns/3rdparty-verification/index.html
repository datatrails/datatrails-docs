<!doctype html><html lang=en-GB><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=Strict-Transport-Security content="max-age=31536000; includeSubDomains"><meta http-equiv=X-Frame-Options content="SAMEORIGIN"><meta http-equiv=X-Content-Type-Options content="nosniff"><meta http-equiv=Referrer-Policy content="no-referrer-when-downgrade"><meta http-equiv=Content-Security-Policy content="style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net/npm/mermaid/dist/; script-src 'self' 'sha256-GoUI0hA42/W90nTDE3+8IM59Pmj5d7MTNu1m0Qv4C+o=' 'sha256-eg7hiIPJDJy7WtCOgK4mlnMdUDYpX6h90ef9pORicds=' https://cdn.jsdelivr.net/npm/mermaid/dist/ https://www.googletagmanager.com/gtag/js js.hs-scripts.com https://js.hscollectedforms.net/collectedforms.js js.hs-analytics.net https://js.usemessages.com/conversations-embed.js https://js.hsadspixel.net/fb.js js.hs-banner.com https://www.google-analytics.com/analytics.js googleads.g.doubleclick.net;"><link rel=preload as=font href=https://docs.datatrails.ai/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://docs.datatrails.ai/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://docs.datatrails.ai/main.c6d014fb8c7ce54b3fa20c1de175b7712c762183e7469e4ce8756d34cbfa5a47a7ce249bae032414f62dbc50462dae57544f3eb01f9efdae84161628644e70f9.css integrity="sha512-xtAU+4x85Us/ogwd4XW3cSx2IYPnRp5M6HVtNMv6WkenziSbrgMkFPYtvFBGLa5XVE8+sB+e/a6EFhYoZE5w+Q==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Verified Replication of the Datatrails Transparency Logs - DataTrails</title>
<meta name=description content="Supporting verified replication of DataTrails merkle logs"><link rel=canonical href=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/RKVST_WhtLogo_CMYK.svg"><meta name=twitter:title content="Verified Replication of the Datatrails Transparency Logs"><meta name=twitter:description content="Supporting verified replication of DataTrails merkle logs"><meta name=twitter:site content="@"><meta name=twitter:creator content="@"><meta property="og:title" content="Verified Replication of the Datatrails Transparency Logs"><meta property="og:description" content="Supporting verified replication of DataTrails merkle logs"><meta property="og:type" content="article"><meta property="og:url" content="/developers/developer-patterns/3rdparty-verification/"><meta property="og:image" content="/RKVST_WhtLogo_CMYK.svg"><meta property="article:published_time" content="2024-08-22T19:35:35+01:00"><meta property="article:modified_time" content="2024-08-22T19:35:35+01:00"><meta property="og:site_name" content="DataTrails"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/docs.datatrails.ai\/"},{"@type":"ListItem","position":3,"name":"Developers","item":"https:\/\/docs.datatrails.ai\/\/developers\/"},{"@type":"ListItem","position":4,"name":"Developer Patterns","item":"https:\/\/docs.datatrails.ai\/\/developers\/developer-patterns\/"},{"@type":"ListItem","position":5,"name":"3rdparty Verification","item":"https:\/\/docs.datatrails.ai\/\/developers\/developer-patterns\/3rdparty-verification\/"}]}</script><meta name=theme-color content="#fff"><link rel=icon type=image/png sizes=32x32 href=https://docs.datatrails.ai/DataTrails_Favicon_32x32.png><link rel=icon type=image/png sizes=16x16 href=https://docs.datatrails.ai/DataTrails_Favicon_16x16.png><link rel=manifest href=https://docs.datatrails.ai/site.webmanifest><script type=text/javascript id=hs-script-loader async defer src=//js.hs-scripts.com/9491266.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-7K46H3KK7N"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-7K46H3KK7N")</script></head><body class="developers single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label>
<a class="navbar-brand order-1 order-md-0 me-auto" style=font-family:Montserrat href=https://www.datatrails.ai>DataTrails</a>
<button id=mode class="btn btn-link order-2 order-md-3" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav main-nav me-auto order-6 order-md-3" style=white-space:nowrap><a href=https://app.datatrails.ai/login target=_blank rel="noopener noreferrer" class="btn btn-link" style=margin-left:20px;font-size:18px role=button>Sign In</a>
<a href=https://app.datatrails.ai/signup target=_blank rel="noopener noreferrer" class="btn btn-primary btn-xs" style=margin-left:10px;font-size:18px;padding-top:9px role=button>Sign Up</a></ul></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2" style=white-space:nowrap><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/>Home</a></li><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/developers/developer-patterns/getting-access-tokens-using-app-registrations/>Developers</a></li><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/platform/overview/core-concepts/>Platform</a></li><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/usecases/authenticity-and-attestation/>Use Cases</a></li><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/glossary/common-datatrails-terms/>Glossary</a></li><li class=nav-item><a class=nav-link href=https://support.datatrails.ai>Support</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#developer-patterns aria-expanded=true>
Developer Patterns</button><div class="collapse show" id=developer-patterns><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/getting-access-tokens-using-app-registrations/>Creating Access Tokens Using a Custom Integration</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/containers-as-assets/>Containers as Assets</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/namespace/>Namespace</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/document-profile/>Document Profile</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/software-package-profile/>Software Package Profile</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/veracity/>Independently verifying DataTrails transparent merkle logs</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/>Navigating the Merkle Log</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables/>Massif blob pre-calculated offsets</a></li><li><a class="docs-link rounded active" href=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/>Verified Replication of the Datatrails Transparency Logs</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/scitt-api/>Quickstart: SCITT Statements (Preview)</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#templates aria-expanded=false>
templates</button><div class=collapse id=templates><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/templates/vcons/>vCon Template</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#api-reference aria-expanded=false>
API Reference</button><div class=collapse id=api-reference><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/app-registrations-api/>App Registrations API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/assets-api/>Assets API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/attachments-api/>Attachments API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/blobs-api/>Blobs API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/compliance-api/>Compliance API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/events-api/>Events API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/iam-policies-api/>IAM Policies API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/iam-subjects-api/>IAM Subjects API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/locations-api/>Locations API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/public-assets-api/>Public Assets API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/tenancies-api/>Tenancies API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/caps-api/>Caps API</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#yaml-reference aria-expanded=false>
YAML Runner Reference</button><div class=collapse id=yaml-reference><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/story-runner-components/>YAML Runner Components</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/assets/>Assets YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/events/>Events YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/locations/>Locations YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/subjects/>Subjects YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/compliance/>Compliance Policies YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/estate-info/>Estate Information YAML Runner</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#replication-recipes>Replication Recipes</a></li><li><a href=#environment-configuration-for-veracity>Environment Configuration for Veracity</a></li><li><a href=#maintaining-a-tamper-evident-log-replica>Maintaining a Tamper Evident Log Replica</a><ul><li><a href=#initializing-a-replica-for-all-tenants>Initializing a Replica for All Tenants</a></li><li><a href=#limiting-the-replica-to-specific-tenants>Limiting the Replica to Specific Tenants</a></li></ul></li><li><a href=#how-veracity-supports-integrity-and-inclusion-protection>How Veracity Supports Integrity and Inclusion Protection</a><ul><li><a href=#updating-the-currently-open-massif>Updating the Currently Open Massif</a></li><li><a href=#replicating-the-next-open-massif>Replicating the Next Open Massif</a></li><li><a href=#replicating-but-leaving-a-gap>Replicating, but Leaving a Gap</a></li></ul></li><li><a href=#replicating-the-log-for-the-public-tenant>Replicating the Log for the Public Tenant</a></li><li><a href=#takeaways>Takeaways</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://docs.datatrails.ai/>Home</a></li><li class=breadcrumb-item><a href=https://docs.datatrails.ai/developers/>Developers</a></li><li class=breadcrumb-item><a href=https://docs.datatrails.ai/developers/developer-patterns/>Developer Patterns</a></li><li class="breadcrumb-item active" aria-current=page>Verified Replication of the Datatrails Transparency Logs</li></ol></nav><div class=my-n3></div><h1>Verified Replication of the Datatrails Transparency Logs</h1><p class=lead>Trust in DataTrails is not required, instead easily maintain a verified replica of a merkle log</p><h2 id=introduction>Introduction<a href=#introduction class=anchor aria-hidden=true>#</a></h2><p>Without the measures described in this article, it is still extremely challenging to compromise a transparency solution based on DataTrails.</p><p>To do so, the systems of more than just DataTrails need to be compromised in very specific ways.
To illustrate this, consider this typical flow for how <strong>Data</strong> can be used in a transparent and tamper evident way with DataTrails.</p><figure class=border-0><input type=image data-bs-toggle=modal data-bs-target=#replicated-data img class="img-fluid responsive" src=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data.png width=6749 height=2328 data-sizes=auto data-srcset="https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_200x0_resize_box_3.png 200w" alt="Replicated Data"><noscript><img class=img-fluid sizes=100vw srcset="https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_200x0_resize_box_3.png 200w" src=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data.png width=6749 height=2328 alt="Replicated Data"></noscript><figcaption class=figure-caption><em>Replicated Transparency Logs</em></figcaption></figure><div class="modal fade" id=replicated-data tabindex=-1 aria-labelledby=replicated-data aria-hidden=true><div class="modal-dialog modal-xl"><div class=modal-body><img class="img-fluid lazyload responsive" data-sizes=auto src=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_100x0_resize_box_3.png data-srcset="https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-data_hud8dc02b70fbaff4c5bba1cdaa917d28f_1735747_200x0_resize_box_3.png 200w" width=6749 height=2328 alt="Replicated Data"></div></div></div><p>This is already a very robust process. For this process to fail, the following steps must all be accomplished:</p><ol><li>The source of the Data, which may not be the Owner, must be compromised to substitute the malicious Data.</li><li>Owner authentication of the Data, such as adding a signed digest in the metadata, must be compromised.</li><li>The DataTrails SaaS database must be compromised.</li><li>The DataTrails ledger must be compromised and re-built and re-signed.</li></ol><p>Executing such an attack successfully would require significant effort and infiltration of both the Data source and DataTrails.
Nonetheless, for use-cases where even this small degree of trust in DataTrails is un-acceptable, the recipes in this article ensure the following guarantees are fully independent of DataTrails:</p><ol><li><strong>The guarantee of non-falsifiability</strong>: Event data can not be falsified.</li><li><strong>The guarantee of non-repudiation</strong>: Event data can not be removed from the record (ie &lsquo;shredded&rsquo; or deleted).</li><li><strong>The guarantee of provability</strong>: Event data held <em>here and now</em> can be proven to be identical to the data created <em>there and then</em> (creating these proofs does not require the original event data).</li><li><strong>The guarantee of demonstrable completeness</strong>: Series of events (trails), can be proven to be complete with no gaps or omissions.</li></ol><p>These guarantees are &ldquo;fail safe&rdquo; against regular data corruption of the log data.
In the event of individual log entry corruption, verification checks would fail for that entry.</p><p>All modifications to the ledger which result in provable changes can be detected without a fully auditable replica.
By maintaining a fully auditable replica, continued verifiable operation is possible even if DataTrails is prevented from operating.
To provide this capability, checking that all metadata is exactly as was originally recorded, A copy of the metadata must also be replicated.
In cases where this capability is required, data retention remains manageable and has completely predictable storage requirements.
The log format makes it operational very simple to discard data that ceases to be interesting.</p><blockquote class="note callout"><div><strong></strong> The metadata is returned to the Owner when the event is recorded and is available from the regular API endpoints to any other authorized party.
Obtaining the returned metadata is not covered in this article.</div></blockquote><h2 id=replication-recipes>Replication Recipes<a href=#replication-recipes class=anchor aria-hidden=true>#</a></h2><h2 id=environment-configuration-for-veracity>Environment Configuration for Veracity<a href=#environment-configuration-for-veracity class=anchor aria-hidden=true>#</a></h2><p>The following recipes make use of these environment:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># DataTrails Public Tenant</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PUBLIC_TENANT</span><span class=o>=</span><span class=s2>&#34;tenant/6ea5cd00-c711-3649-6914-7b125928bbb4&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Synsation Demo Tenant</span>
</span></span><span class=line><span class=cl><span class=c1># Replace TENANT with your Tenant ID to view your Tenant logs and events</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TENANT</span><span class=o>=</span><span class=s2>&#34;tenant/6a009b40-eb55-4159-81f0-69024f89f53c&#34;</span>
</span></span></code></pre></div><h2 id=maintaining-a-tamper-evident-log-replica>Maintaining a Tamper Evident Log Replica<a href=#maintaining-a-tamper-evident-log-replica class=anchor aria-hidden=true>#</a></h2><p>Based on a window of assurance, a replica may be maintained with one command, once a week.</p><p>A guarantee that actions are only taken on verified data can be achieved by running the following command once a week:</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patterns3rdparty-verification-1 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patterns3rdparty-verification-1-0 type=button role=tab aria-controls=tabset-developersdeveloper-patterns3rdparty-verification-1-0 aria-selected=true>bash</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patterns3rdparty-verification-1><div id=tabset-developersdeveloper-patterns3rdparty-verification-1-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patterns3rdparty-verification-1-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>veracity watch --horizon 180h <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  veracity <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  replicate-logs --replicadir merklelogs
</span></span></code></pre></div><p>Run the following to see what was replicated:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>find merklelogs -type f
</span></span></code></pre></div><p>Generates output similar to:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>merklelogs/tenant/6ea5cd00-c711-3649-6914-7b125928bbb4/0/massifs/0000000000000001.log
</span></span><span class=line><span class=cl>merklelogs/tenant/6ea5cd00-c711-3649-6914-7b125928bbb4/0/massifs/0000000000000000.log
</span></span><span class=line><span class=cl>merklelogs/tenant/6ea5cd00-c711-3649-6914-7b125928bbb4/0/massifseals/0000000000000000.sth
</span></span><span class=line><span class=cl>merklelogs/tenant/6ea5cd00-c711-3649-6914-7b125928bbb4/0/massifseals/0000000000000001.sth
</span></span></code></pre></div></div></div><p>A sensible value for <code>--horizon</code> is just a little (hours is more than enough) longer than the interval between updates.
To <em>miss</em> an update for a tenant, more than 16,000 events would need to be recorded in the interval.</p><blockquote class="note callout"><div><strong></strong> Larger time horizons may trigger rate limiting</div></blockquote><h3 id=initializing-a-replica-for-all-tenants>Initializing a Replica for All Tenants<a href=#initializing-a-replica-for-all-tenants class=anchor aria-hidden=true>#</a></h3><p>If a replica of all DataTrails tenants is required, run the previous command with a very long horizon.</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patterns3rdparty-verification-2 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patterns3rdparty-verification-2-0 type=button role=tab aria-controls=tabset-developersdeveloper-patterns3rdparty-verification-2-0 aria-selected=true>bash</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patterns3rdparty-verification-2><div id=tabset-developersdeveloper-patterns3rdparty-verification-2-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patterns3rdparty-verification-2-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>veracity watch --horizon 90000h <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  veracity <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  replicate-logs --replicadir merklelogs
</span></span></code></pre></div></div></div><p>Having done this once, you should revert to using a horizon that is just a little longer than your update interval.</p><h3 id=limiting-the-replica-to-specific-tenants>Limiting the Replica to Specific Tenants<a href=#limiting-the-replica-to-specific-tenants class=anchor aria-hidden=true>#</a></h3><p>The previous command will replicate the logs of all tenants.
This requires about 3.5 megabytes per 16,000 events.</p><p>To restrict a replica to a specific set of tenants, specify those tenants to the <code>watch</code> command.</p><p>A common requirement is the public attestation tenant and your own tenant, to accomplish this set <code>$TENANT</code> accordingly and run the following once a week.</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patterns3rdparty-verification-3 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patterns3rdparty-verification-3-0 type=button role=tab aria-controls=tabset-developersdeveloper-patterns3rdparty-verification-3-0 aria-selected=true>bash</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patterns3rdparty-verification-3><div id=tabset-developersdeveloper-patterns3rdparty-verification-3-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patterns3rdparty-verification-3-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>veracity --tenant <span class=s2>&#34;</span><span class=nv>$PUBLIC_TENANT</span><span class=s2>,</span><span class=nv>$TENANT</span><span class=s2>&#34;</span> watch --horizon 180h <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  veracity <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  replicate-logs --replicadir merklelogs
</span></span></code></pre></div></div></div><p>To initialize the replica, run the same command once but using an appropriately large <code>--horizon</code></p><p>The remainder of this article discusses the commands <code>replicate-logs</code> and <code>watch</code> in more depth, covering how to replicate selective tenants, explaining the significance of the replicated materials.</p><h2 id=how-veracity-supports-integrity-and-inclusion-protection>How Veracity Supports Integrity and Inclusion Protection<a href=#how-veracity-supports-integrity-and-inclusion-protection class=anchor aria-hidden=true>#</a></h2><p>DataTrail&rsquo;s log format makes it simple to retain only the portions (massifs) of the log that are interesting.
Discarding un-interesting portions does not affect the independence or verifiability of the retained log.</p><p>See
<a href=https://docs.datatrails.ai/developers/developer-patterns/veracity/>Independently verifying DataTrails transparent merkle logs</a> for a general introduction to <code>veracity</code>.</p><p>This diagram illustrates the logical flow when updating a local replica using veracity.</p><hr><div class=mermaid>---
config:
theme: classic
---
sequenceDiagram
actor v as Verifier
box Runs locally to the verifier
participant V as Veracity
participant R as Replica
end
participant D as DataTrails
v -->> V: Safely update my replica to massif X please
V ->> D: Fetch and verify the remote massifs and seals up to X
V ->> R: Check the verified remote data is consistent with the replica
V ->> R: Update the replica with verified additions
V -->> v: All OK!</div><hr><p>For the guarantees of <em>non-falsifiability</em> and <em>non-repudiation</em> to be independent of DataTrails, replication and verification of at least the most recently updated massif is necessary.
The replica must be updated often enough to capture all massifs.
As a massif, in the default tenant configuration, contains over 16,000 events, the frequency necessary to support this guarantee is both low, and completely determined by the specific tenant of interest.</p><p>Massifs verifying events that are no longer interesting can be safely discarded.
Remembering that the order that events were recorded matches the order of data in the log, it is usually the case that all massifs before a certain point can be discarded together.</p><p>Saving the API response data when events are recoded, or obtaining the metadata using the DataTrails events API is additionally required in order to support a full audit for data corruption.</p><p>When a a trusted local copy of the verifiable log is included in the &ldquo;verify before use&rdquo; process, it is reasonable to rely on DataTrails storage of the metadata.
If the DataTrails storage of the metadata is changed, the verification will &ldquo;fail safe&rdquo; against the local replicated log because the changed data will not verify against the local replica.
While this is a &ldquo;false negative&rdquo;, it ensures safety in the face of accidental or malicious damage to the DataTrails storage systems without the burden of maintaining copies of the metadata recorded in DataTrails.
Once the unsafe action is blocked, it is very use-case dependent what the appropriate next steps are. The common thread is that is <em>critical</em> that the action must be blocked in the first instance.</p><p>When the metadata is fetched, if it can be verified against the log replica, it proves that the DataTrails storage remains correct.
If it does not verify, it is proven that the metadata held by DataTrails is incorrect, though the <em>Data</em> being processed by the Consumer may still be correct and safe.</p><p>The <code>veracity</code> <code>replicate-logs</code> and <code>watch</code> are used to maintain the replica of the verifiable log.</p><ul><li><code>veracity watch</code> is used to give notice of which tenants have updates to their logs that need to be considered for replication.</li><li><code>veracity replicate-logs</code> performs the activities in the diagram above. It can be directed to examine a specific tenant, or it can be provided with the output of <code>veracity watch</code></li></ul><h3 id=updating-the-currently-open-massif>Updating the Currently Open Massif<a href=#updating-the-currently-open-massif class=anchor aria-hidden=true>#</a></h3><p>Every DataTrails log is a series of one or more massifs.
The last, called the head, is where verification data for new events are recorded.
Once the head is full, a new head automatically starts.</p><p>This means there are 3 basic scenarios <code>veracity</code> copes with when updating a replica.</p><ol><li>Updating the currently open replicated massif with the new additions in the DataTrails open massif.</li><li>Replicating the start of a new open massif from DataTrails.</li><li>Replicating a limited number of new massifs from DataTrails, performing local consistency checks only if the replicated massifs follow the latest local massif.</li></ol><p>The first is the simplest to understand. In the diagram below the dashed boxes correspond to the open massifs.</p><p>The local replica of the open massif will always be equal or less in size than the remote.
Once veracity verifies the remote copy is consistent with the remote seal, it will then check the new data copied from the remote is consistent with its local copy of the open massif.
Consistent simply means it is an append, and that the remote has not &ldquo;dropped&rdquo; anything that it contained the last time it was replicated.</p><p>If there is any discrepancy in any of these checks, the current local data is left unchanged.</p><figure class=border-0><input type=image data-bs-toggle=modal data-bs-target=#replicated-veracity img class="img-fluid responsive" src=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity.png width=4286 height=2143 data-sizes=auto data-srcset="https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_200x0_resize_box_3.png 200w" alt="Replicating with Veracity"><noscript><img class=img-fluid sizes=100vw srcset="https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_200x0_resize_box_3.png 200w" src=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity.png width=4286 height=2143 alt="Replicating with Veracity"></noscript><figcaption class=figure-caption><em>Replicating Transparency Logs with Veracity</em></figcaption></figure><div class="modal fade" id=replicated-veracity tabindex=-1 aria-labelledby=replicated-veracity aria-hidden=true><div class="modal-dialog modal-xl"><div class=modal-body><img class="img-fluid lazyload responsive" data-sizes=auto src=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_100x0_resize_box_3.png data-srcset="https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity_hu0ec4b8cf04f1f64d8e03526eaf7d3627_1899025_200x0_resize_box_3.png 200w" width=4286 height=2143 alt="Replicating with Veracity"></div></div></div><h3 id=replicating-the-next-open-massif>Replicating the Next Open Massif<a href=#replicating-the-next-open-massif class=anchor aria-hidden=true>#</a></h3><p>The local replica starts out only having Massifs 0 & 1.
And 1 happens to be complete.
On the next event recorded by DataTrails, a new remote massif, Massif 2, is created.
More events may be recorded before the replica is updated.
Each massif contains verification data for a little over 16,000 events.
Provided the replication commands are run before Massif 2 is also filled, we are dealing with this case.</p><p>The local Massif 1 is read because, before copying the remote Massif 2 into the local replica, its consistency against both the remote seal <em>and</em> the previous <em>local</em> massif, Massif 1, are checked.</p><p>Once those checks are successfully made, the local replica gains its initial copy of Massif 2.</p><figure class=border-0><input type=image data-bs-toggle=modal data-bs-target=#replicated-veracity-2 img class="img-fluid responsive" src=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2.png width=4286 height=2735 data-sizes=auto data-srcset="https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_200x0_resize_box_3.png 200w" alt="Replicating Next Open Massif"><noscript><img class=img-fluid sizes=100vw srcset="https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_200x0_resize_box_3.png 200w" src=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2.png width=4286 height=2735 alt="Replicating Next Open Massif"></noscript><figcaption class=figure-caption><em>Replicating The Next Open Massif with Veracity</em></figcaption></figure><div class="modal fade" id=replicated-veracity-2 tabindex=-1 aria-labelledby=replicated-veracity-2 aria-hidden=true><div class="modal-dialog modal-xl"><div class=modal-body><img class="img-fluid lazyload responsive" data-sizes=auto src=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_100x0_resize_box_3.png data-srcset="https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-2_hu627a57ac4dfe17745a2cc64fabadb49e_2377823_200x0_resize_box_3.png 200w" width=4286 height=2735 alt="Replicating Next Open Massif"></div></div></div><h3 id=replicating-but-leaving-a-gap>Replicating, but Leaving a Gap<a href=#replicating-but-leaving-a-gap class=anchor aria-hidden=true>#</a></h3><p>By default, veracity will fetch and verify all massifs, up to the requested, that follow on immediately after the most recent local massif.
In this case, where we request <code>--massif 4</code> the default would be to fetch, verify and replicate Massifs 2, 3 & 4.</p><p>By default, a full tenant log is replicated.
The storage requirements are roughly 4mb per massif, and each massif has the verification data for about 16,000 events.</p><p>To provide a means to bound the size of the local replica and also to bound the amount of work, we provide the <code>--ancestors</code> option.
This specifies a fixed limit on the number of massifs that will be fetched.
In this example, the limit is <code>0</code>, meaning massif 4 is fetched and verified, and we leave a <em>gap</em> between the local massifs 2 & the new local massif 4.
The gap means the consistency of the remote massif 4 is <em>not</em> checked against the local replica.</p><p>The command <code>veracity replicate-logs --ancestors 0 --massif 4</code> requests that massif 4 is verified and then replicated locally, but prevents it from being verified for consistency against the current local replica.</p><figure class=border-0><input type=image data-bs-toggle=modal data-bs-target=#replicated-veracity-gaps img class="img-fluid responsive" src=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps.png width=4286 height=2848 data-sizes=auto data-srcset="https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_200x0_resize_box_3.png 200w" alt="Replicating With Gaps"><noscript><img class=img-fluid sizes=100vw srcset="https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_200x0_resize_box_3.png 200w" src=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps.png width=4286 height=2848 alt="Replicating With Gaps"></noscript><figcaption class=figure-caption><em>Replicating The With Gaps</em></figcaption></figure><div class="modal fade" id=replicated-veracity-gaps tabindex=-1 aria-labelledby=replicated-veracity-gaps aria-hidden=true><div class="modal-dialog modal-xl"><div class=modal-body><img class="img-fluid lazyload responsive" data-sizes=auto src=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_100x0_resize_box_3.png data-srcset="https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/replicated-veracity-gaps_huf5faa485887d84e403246fecae05a9e2_2502040_200x0_resize_box_3.png 200w" width=4286 height=2848 alt="Replicating With Gaps"></div></div></div><h2 id=replicating-the-log-for-the-public-tenant>Replicating the Log for the Public Tenant<a href=#replicating-the-log-for-the-public-tenant class=anchor aria-hidden=true>#</a></h2><p>For illustration, we take a more detailed look at using <code>watch</code> and <code>replicate-logs</code> to replicate the public tenant verifiable log data.</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patterns3rdparty-verification-4 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patterns3rdparty-verification-4-0 type=button role=tab aria-controls=tabset-developersdeveloper-patterns3rdparty-verification-4-0 aria-selected=true>bash</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patterns3rdparty-verification-4><div id=tabset-developersdeveloper-patterns3rdparty-verification-4-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patterns3rdparty-verification-4-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>veracity --tenant <span class=nv>$PUBLIC_TENANT</span> watch
</span></span></code></pre></div><p>Generates output similar to:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;massifindex&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;tenant&#34;</span><span class=p>:</span> <span class=s2>&#34;tenant/6ea5cd00-c711-3649-6914-7b125928bbb4&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;idcommitted&#34;</span><span class=p>:</span> <span class=s2>&#34;0191c424e62d04b300&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;idconfirmed&#34;</span><span class=p>:</span> <span class=s2>&#34;0191c424e62d04b300&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;lastmodified&#34;</span><span class=p>:</span> <span class=s2>&#34;2024-09-05T21:43:58Z&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;massif&#34;</span><span class=p>:</span> <span class=s2>&#34;v1/mmrs/tenant/6ea5cd00-c711-3649-6914-7b125928bbb4/0/massifs/0000000000000001.log&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;seal&#34;</span><span class=p>:</span> <span class=s2>&#34;v1/mmrs/tenant/6ea5cd00-c711-3649-6914-7b125928bbb4/0/massifseals/0000000000000001.sth&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p>If instead you get:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>error: no changes found
</span></span></code></pre></div><p>There has been no activity in any tenant for the default watch horizon (how far back we look for changes).</p><p>To set an explicit, and in this example very large, horizon try the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>veracity watch --horizon 10000h
</span></span></code></pre></div></div></div><p>The <code>watch</code> command is used to determine the <code>massifindex</code>, even when you are only interested in a single tenant.
You then provide that index to the <code>replicate-logs</code> command using the <code>--massif</code> option:</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patterns3rdparty-verification-5 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patterns3rdparty-verification-5-0 type=button role=tab aria-controls=tabset-developersdeveloper-patterns3rdparty-verification-5-0 aria-selected=true>bash</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patterns3rdparty-verification-5><div id=tabset-developersdeveloper-patterns3rdparty-verification-5-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patterns3rdparty-verification-5-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>veracity <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --tenant <span class=nv>$PUBLIC_TENANT</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    replicate-logs --massif <span class=m>1</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --replicadir merklelogs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>find merklelogs -type f
</span></span></code></pre></div><p>Generates output similar to:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>merklelogs/tenant/6ea5cd00-c711-3649-6914-7b125928bbb4/0/massifs/0000000000000001.log
</span></span><span class=line><span class=cl>merklelogs/tenant/6ea5cd00-c711-3649-6914-7b125928bbb4/0/massifs/0000000000000000.log
</span></span><span class=line><span class=cl>merklelogs/tenant/6ea5cd00-c711-3649-6914-7b125928bbb4/0/massifseals/0000000000000000.sth
</span></span><span class=line><span class=cl>merklelogs/tenant/6ea5cd00-c711-3649-6914-7b125928bbb4/0/massifseals/0000000000000001.sth
</span></span></code></pre></div></div></div><p>By default, all massifs up to and including the massif specified by <code>--massif &lt;N></code> are verified remotely and checked for consistency against the local replica (following the logical steps in the diagram above).</p><p>The numbered <code>.log</code> files are the verifiable data for your log.</p><p>The <code>.sth</code> files are
<a href=https://datatracker.ietf.org/doc/html/rfc8152#section-4.2 target=_blank rel=noopener>COSE Sign1</a> binary format signed messages.
Each <code>.sth</code> is associated with the identically numbered massif.
The log root material in the <code>.sth</code> signature attests to the entire state of the log up to the end of the associated massif.
The details of consuming the binary format of the seal and verifying the signature are beyond the scope of this article.</p><p>However, the implementation used by <code>veracity</code> can be found in the open source merkle log library maintained by DataTrails
<a href=https://github.com/datatrails/go-datatrails-merklelog/blob/main/massifs/rootsigverify.go target=_blank rel=noopener>go-datatrails-merklelog</a></p><h2 id=takeaways>Takeaways<a href=#takeaways class=anchor aria-hidden=true>#</a></h2><ul><li>To be sure mistaken, or malicious, changes to DataTrails data stores can always be detected run this command about once a week:
<code>veracity --tenant $TENANT watch --horizon 180h | veracity replicate-logs --replicadir merklelogs</code></li><li>This process guarantees you can&rsquo;t be misrepresented, any alternate version of events would be provably false.</li><li>To guarantee continued operation even if DataTrails is prevented from operating, a copy of the DataTrails metadata must be retained.</li><li>You can reasonably chose to trust DataTrails copy, because, even in the most extreme cases, it is &ldquo;fail-safe&rdquo; if DataTrails SaaS storage is compromised, when combined with a replicated verifiable merkle log.</li></ul><p class=edit-page></p><div class="docs-navigation d-flex justify-content-between"><a href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables/><div class="card my-1"><div class="card-body py-2">&larr; Massif blob pre-calculated offsets</div></div></a><a class=ms-auto href=https://docs.datatrails.ai/developers/api-reference/app-registrations-api/><div class="card my-1"><div class="card-body py-2">App Registrations API &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div><div class="col-lg-8 order-first text-lg-end"><ul class=list-inline><li>Can't find what you're looking for? Search our <a href=https://support.datatrails.ai>Support Knowledgebase</a> or <a href=mailto:support@datatrails.ai>email Support</a></li></ul></div></div></div></footer><script type=module src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs>
  
  
</script><script src=https://docs.datatrails.ai/js/bootstrap.min.b4d48dd4d57c29a63a0ea5455b6d5b16f032e551e190ca88c04a0e5dd6b64b01657b3e1f44ff6e670ab72166686b0572f94c18d2f8d14c1a01aaf5f8e28fb345.js integrity="sha512-tNSN1NV8KaY6DqVFW21bFvAy5VHhkMqIwEoOXda2SwFlez4fRP9uZwq3IWZoawVy+UwY0vjRTBoBqvX44o+zRQ==" crossorigin=anonymous defer></script><script src=https://docs.datatrails.ai/js/highlight.min.3a4cb2619581c8c2a404737dff7063a4e54839fe2c53b904ffe261df02fe8da83fd12660ac8b0adbd432aa1b63fca6c49862e114f46cf2008058b9e29853d84b.js integrity="sha512-OkyyYZWByMKkBHN9/3BjpOVIOf4sU7kE/+Jh3wL+jag/0SZgrIsK29Qyqhtj/KbEmGLhFPRs8gCAWLnimFPYSw==" crossorigin=anonymous defer></script><script src=https://docs.datatrails.ai/main.min.5a11cd173e56732b0a703e2f8ecf68ea541e5db0cfb67389769e34602825b7b2517cd5043ac8da49638c3e5edbeb2706e035cf5a1ab50f79ddff45ab24f6122c.js integrity="sha512-WhHNFz5WcysKcD4vjs9o6lQeXbDPtnOJdp40YCglt7JRfNUEOsjaSWOMPl7b6ycG4DXPWhq1D3nd/0WrJPYSLA==" crossorigin=anonymous defer></script><script src=https://docs.datatrails.ai/index.min.817920a2f857aec53d53752f1a7ce9925e2fbeb1f64ab105e4554fac33e6746877be73bac69edaca1afe4f322a7cc609805c7f722c5cd2f16e052306c1b43b74.js integrity="sha512-gXkgovhXrsU9U3UvGnzpkl4vvrH2SrEF5FVPrDPmdGh3vnO6xp7ayhr+TzIqfMYJgFx/cixc0vFuBSMGwbQ7dA==" crossorigin=anonymous defer></script></body></html>