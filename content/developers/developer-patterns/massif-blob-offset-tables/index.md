---
 title: "Massif blob pre-calculated offsets"
 description: "Provides pre calculated tables for navigating raw merklelog's"
 lead: "lookup tables for navigating the dynamic, but computable, offsets into the merkle log binary format"
 draft: false
 images: []
 menu:
   developers:
     parent: "developer-patterns"
 weight: 34
 toc: true
---

This page provides lookup tables for navigating the dynamic, but computable,
offsets into the merkle log binary format. The algorithms to reproduce this are
relatively simple, we provide open source implementations, but in many contexts
it is simpler to use these pre-calculations. These tables can be made for
any log configuration at any time, in part or in whole, without access to any
specific log.

A fast review of the log format. We explain this in more detail at [Navigating MerkleLogs](/developers/developer-patterns/navigating-merklelogs)

## Each log is comprised of many blobs, each containing a fixed number of leaves

    +----------------+ +----------------+ .. +-----------+
    |     massif 0   | |     massif 1   |    |  massif n
    +----------------+ +----------------+ .. +-----------+

The last blob is the blob that new leaves are added to

## Each individual blob has a fixed size portion and two variably sized sections

    |--------.----------.----------.---------|
    |  fixed  size      | computable size    |
    |--------.----------.----------.---------|
    | header | trieData |peak stack| mmrData |
    |--------.----------.----------.---------|


## The peak stack and mmr data sizes are computable

But it is not always convenient to do so.


Using the `veracity` tool with the following command line we can reproduce
our cannonical "illustrative" log from [Navigating MerkleLogs](/developers/developer-patterns/navigating-merklelogs)


                       14
                          \
                6           13             21
                  \            \              \
    h=2 1 |  2  |  5  |   9  |  12   |  17   | 20  |
          |     |     |      |       |       |     |
        0 |0   1| 3  4| 7   8|10   11|15   16|18 19|


    go run veracity/cmd/veracity/main.go --height 2 massifs --count 6



In the following table *Stack Start* and *mmr Start* are byte offsets from the
start of the file. The leaf values are indices into the trie fields (not
considered further in this page) and the
node values are indices into the array of 32 byte nodes starting at *mmr Start*

| Massif | Stack Start| mmr Start |  First leaf | Last Leaf | First Node  | Last Node | Peak Stack |
| -------| ---------- | --------- | ---------- | ---------- | ----------- | --------- | ---------  |
|       0|   1048864  |  1048864  |       0    |    8192    |        0    |    16382  | []
|       1|   1048864  |  1048896  |    8192    |   16384    |    16383    |    32766  | [16382]
|       2|   1048864  |  1048896  |   16384    |   24576    |    32767    |    49149  | [32766]
|       3|   1048864  |  1048928  |   24576    |   32768    |    49150    |    65534  | [32766,49149]
|       4|   1048864  |  1048896  |   32768    |   40960    |    65535    |    81917  | [65534]
|       5|   1048864  |  1048928  |   40960    |   49152    |    81918    |    98301  | [65534,81917]
|       6|   1048864  |  1048928  |   49152    |   57344    |    98302    |   114684  | [65534,98301]

It is fairly easy to validate the leaves and nodes by hand. The reproducing the
Stack Start needs details from [Navigating MerkleLogs](/developers/developer-patterns/navigating-merklelogs)


## Pre-computes for your first million events

| Massif | Stack Start| mmr Start |  First leaf | Last Leaf | First Node  | Last Node | Peak Stack |
| -------| ---------- | --------- | ---------- | ---------- | ----------- | --------- | ---------  |
|       0| 1048864| 1048864 |       0|    8192|        0|    16382| []
|       1| 1048864| 1048896 |    8192|   16384|    16383|    32766| [16382]
|       2| 1048864| 1048896 |   16384|   24576|    32767|    49149| [32766]
|       3| 1048864| 1048928 |   24576|   32768|    49150|    65534| [32766,49149]
|       4| 1048864| 1048896 |   32768|   40960|    65535|    81917| [65534]
|       5| 1048864| 1048928 |   40960|   49152|    81918|    98301| [65534,81917]
|       6| 1048864| 1048928 |   49152|   57344|    98302|   114684| [65534,98301]
|       7| 1048864| 1048960 |   57344|   65536|   114685|   131070| [65534,98301,114684]
|       8| 1048864| 1048896 |   65536|   73728|   131071|   147453| [131070]
|       9| 1048864| 1048928 |   73728|   81920|   147454|   163837| [131070,147453]
|      10| 1048864| 1048928 |   81920|   90112|   163838|   180220| [131070,163837]
|      11| 1048864| 1048960 |   90112|   98304|   180221|   196605| [131070,163837,180220]
|      12| 1048864| 1048928 |   98304|  106496|   196606|   212988| [131070,196605]
|      13| 1048864| 1048960 |  106496|  114688|   212989|   229372| [131070,196605,212988]
|      14| 1048864| 1048960 |  114688|  122880|   229373|   245755| [131070,196605,229372]
|      15| 1048864| 1048992 |  122880|  131072|   245756|   262142| [131070,196605,229372,245755]
|      16| 1048864| 1048896 |  131072|  139264|   262143|   278525| [262142]
|      17| 1048864| 1048928 |  139264|  147456|   278526|   294909| [262142,278525]
|      18| 1048864| 1048928 |  147456|  155648|   294910|   311292| [262142,294909]
|      19| 1048864| 1048960 |  155648|  163840|   311293|   327677| [262142,294909,311292]
|      20| 1048864| 1048928 |  163840|  172032|   327678|   344060| [262142,327677]
|      21| 1048864| 1048960 |  172032|  180224|   344061|   360444| [262142,327677,344060]
|      22| 1048864| 1048960 |  180224|  188416|   360445|   376827| [262142,327677,360444]
|      23| 1048864| 1048992 |  188416|  196608|   376828|   393213| [262142,327677,360444,376827]
|      24| 1048864| 1048928 |  196608|  204800|   393214|   409596| [262142,393213]
|      25| 1048864| 1048960 |  204800|  212992|   409597|   425980| [262142,393213,409596]
|      26| 1048864| 1048960 |  212992|  221184|   425981|   442363| [262142,393213,425980]
|      27| 1048864| 1048992 |  221184|  229376|   442364|   458748| [262142,393213,425980,442363]
|      28| 1048864| 1048960 |  229376|  237568|   458749|   475131| [262142,393213,458748]
|      29| 1048864| 1048992 |  237568|  245760|   475132|   491515| [262142,393213,458748,475131]
|      30| 1048864| 1048992 |  245760|  253952|   491516|   507898| [262142,393213,458748,491515]
|      31| 1048864| 1049024 |  253952|  262144|   507899|   524286| [262142,393213,458748,491515,507898]
|      32| 1048864| 1048896 |  262144|  270336|   524287|   540669| [524286]
|      33| 1048864| 1048928 |  270336|  278528|   540670|   557053| [524286,540669]
|      34| 1048864| 1048928 |  278528|  286720|   557054|   573436| [524286,557053]
|      35| 1048864| 1048960 |  286720|  294912|   573437|   589821| [524286,557053,573436]
|      36| 1048864| 1048928 |  294912|  303104|   589822|   606204| [524286,589821]
|      37| 1048864| 1048960 |  303104|  311296|   606205|   622588| [524286,589821,606204]
|      38| 1048864| 1048960 |  311296|  319488|   622589|   638971| [524286,589821,622588]
|      39| 1048864| 1048992 |  319488|  327680|   638972|   655357| [524286,589821,622588,638971]
|      40| 1048864| 1048928 |  327680|  335872|   655358|   671740| [524286,655357]
|      41| 1048864| 1048960 |  335872|  344064|   671741|   688124| [524286,655357,671740]
|      42| 1048864| 1048960 |  344064|  352256|   688125|   704507| [524286,655357,688124]
|      43| 1048864| 1048992 |  352256|  360448|   704508|   720892| [524286,655357,688124,704507]
|      44| 1048864| 1048960 |  360448|  368640|   720893|   737275| [524286,655357,720892]
|      45| 1048864| 1048992 |  368640|  376832|   737276|   753659| [524286,655357,720892,737275]
|      46| 1048864| 1048992 |  376832|  385024|   753660|   770042| [524286,655357,720892,753659]
|      47| 1048864| 1049024 |  385024|  393216|   770043|   786429| [524286,655357,720892,753659,770042]
|      48| 1048864| 1048928 |  393216|  401408|   786430|   802812| [524286,786429]
|      49| 1048864| 1048960 |  401408|  409600|   802813|   819196| [524286,786429,802812]
|      50| 1048864| 1048960 |  409600|  417792|   819197|   835579| [524286,786429,819196]
|      51| 1048864| 1048992 |  417792|  425984|   835580|   851964| [524286,786429,819196,835579]
|      52| 1048864| 1048960 |  425984|  434176|   851965|   868347| [524286,786429,851964]
|      53| 1048864| 1048992 |  434176|  442368|   868348|   884731| [524286,786429,851964,868347]
|      54| 1048864| 1048992 |  442368|  450560|   884732|   901114| [524286,786429,851964,884731]
|      55| 1048864| 1049024 |  450560|  458752|   901115|   917500| [524286,786429,851964,884731,901114]
|      56| 1048864| 1048960 |  458752|  466944|   917501|   933883| [524286,786429,917500]
|      57| 1048864| 1048992 |  466944|  475136|   933884|   950267| [524286,786429,917500,933883]
|      58| 1048864| 1048992 |  475136|  483328|   950268|   966650| [524286,786429,917500,950267]
|      59| 1048864| 1049024 |  483328|  491520|   966651|   983035| [524286,786429,917500,950267,966650]
|      60| 1048864| 1048992 |  491520|  499712|   983036|   999418| [524286,786429,917500,983035]
|      61| 1048864| 1049024 |  499712|  507904|   999419|  1015802| [524286,786429,917500,983035,999418]
|      62| 1048864| 1049024 |  507904|  516096|  1015803|  1032185| [524286,786429,917500,983035,1015802]
|      63| 1048864| 1049056 |  516096|  524288|  1032186|  1048574| [524286,786429,917500,983035,1015802,1032185]
