<!doctype html><html lang=en-GB><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=Strict-Transport-Security content="max-age=31536000; includeSubDomains"><meta http-equiv=X-Frame-Options content="SAMEORIGIN"><meta http-equiv=X-Content-Type-Options content="nosniff"><meta http-equiv=Referrer-Policy content="no-referrer-when-downgrade"><meta http-equiv=Content-Security-Policy content="style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net/npm/mermaid/dist/; script-src 'self' 'sha256-GoUI0hA42/W90nTDE3+8IM59Pmj5d7MTNu1m0Qv4C+o=' 'sha256-eg7hiIPJDJy7WtCOgK4mlnMdUDYpX6h90ef9pORicds=' https://cdn.jsdelivr.net/npm/mermaid/dist/ https://www.googletagmanager.com/gtag/js js.hs-scripts.com https://js.hscollectedforms.net/collectedforms.js js.hs-analytics.net https://js.usemessages.com/conversations-embed.js https://js.hsadspixel.net/fb.js js.hs-banner.com https://www.google-analytics.com/analytics.js googleads.g.doubleclick.net;"><link rel=preload as=font href=https://docs.datatrails.ai/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://docs.datatrails.ai/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://docs.datatrails.ai/main.c6d014fb8c7ce54b3fa20c1de175b7712c762183e7469e4ce8756d34cbfa5a47a7ce249bae032414f62dbc50462dae57544f3eb01f9efdae84161628644e70f9.css integrity="sha512-xtAU+4x85Us/ogwd4XW3cSx2IYPnRp5M6HVtNMv6WkenziSbrgMkFPYtvFBGLa5XVE8+sB+e/a6EFhYoZE5w+Q==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Navigating the Merkle Log - DataTrails</title>
<meta name=description content="Describes the serialization format of the DataTrails verifiable data structure"><link rel=canonical href=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/RKVST_WhtLogo_CMYK.svg"><meta name=twitter:title content="Navigating the Merkle Log"><meta name=twitter:description content="Describes the serialization format of the DataTrails verifiable data structure"><meta name=twitter:site content="@"><meta name=twitter:creator content="@"><meta property="og:title" content="Navigating the Merkle Log"><meta property="og:description" content="Describes the serialization format of the DataTrails verifiable data structure"><meta property="og:type" content="article"><meta property="og:url" content="/developers/developer-patterns/navigating-merklelogs/"><meta property="og:image" content="/RKVST_WhtLogo_CMYK.svg"><meta property="og:site_name" content="DataTrails"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/docs.datatrails.ai\/"},{"@type":"ListItem","position":3,"name":"Developers","item":"https:\/\/docs.datatrails.ai\/\/developers\/"},{"@type":"ListItem","position":4,"name":"Developer Patterns","item":"https:\/\/docs.datatrails.ai\/\/developers\/developer-patterns\/"},{"@type":"ListItem","position":5,"name":"Navigating Merklelogs","item":"https:\/\/docs.datatrails.ai\/\/developers\/developer-patterns\/navigating-merklelogs\/"}]}</script><meta name=theme-color content="#fff"><link rel=icon type=image/png sizes=32x32 href=https://docs.datatrails.ai/DataTrails_Favicon_32x32.png><link rel=icon type=image/png sizes=16x16 href=https://docs.datatrails.ai/DataTrails_Favicon_16x16.png><link rel=manifest href=https://docs.datatrails.ai/site.webmanifest><script type=text/javascript id=hs-script-loader async defer src=//js.hs-scripts.com/9491266.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-7K46H3KK7N"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-7K46H3KK7N")</script></head><body class="developers single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label>
<a class="navbar-brand order-1 order-md-0 me-auto" style=font-family:Montserrat href=https://www.datatrails.ai>DataTrails</a>
<button id=mode class="btn btn-link order-2 order-md-3" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav main-nav me-auto order-6 order-md-3" style=white-space:nowrap><a href=https://app.datatrails.ai/login target=_blank rel="noopener noreferrer" class="btn btn-link" style=margin-left:20px;font-size:18px role=button>Sign In</a>
<a href=https://app.datatrails.ai/signup target=_blank rel="noopener noreferrer" class="btn btn-primary btn-xs" style=margin-left:10px;font-size:18px;padding-top:9px role=button>Sign Up</a></ul></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2" style=white-space:nowrap><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/>Home</a></li><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/developers/developer-patterns/getting-access-tokens-using-app-registrations/>Developers</a></li><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/platform/overview/core-concepts/>Platform</a></li><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/usecases/authenticity-and-attestation/>Use Cases</a></li><li class=nav-item><a class=nav-link href=https://docs.datatrails.ai/glossary/common-datatrails-terms/>Glossary</a></li><li class=nav-item><a class=nav-link href=https://support.datatrails.ai>Support</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#developer-patterns aria-expanded=true>
Developer Patterns</button><div class="collapse show" id=developer-patterns><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/getting-access-tokens-using-app-registrations/>Creating Access Tokens Using a Custom Integration</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/containers-as-assets/>Containers as Assets</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/namespace/>Namespace</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/document-profile/>Document Profile</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/software-package-profile/>Software Package Profile</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/veracity/>Independently verifying DataTrails transparent merkle logs</a></li><li><a class="docs-link rounded active" href=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/>Navigating the Merkle Log</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables/>Massif blob pre-calculated offsets</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/3rdparty-verification/>Verified Replication of the Datatrails Transparency Logs</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/developer-patterns/scitt-api/>Quickstart: SCITT Statements (Preview)</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#templates aria-expanded=false>
templates</button><div class=collapse id=templates><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/templates/vcons/>vCon Template</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#api-reference aria-expanded=false>
API Reference</button><div class=collapse id=api-reference><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/app-registrations-api/>App Registrations API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/assets-api/>Assets API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/attachments-api/>Attachments API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/blobs-api/>Blobs API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/compliance-api/>Compliance API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/events-api/>Events API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/iam-policies-api/>IAM Policies API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/iam-subjects-api/>IAM Subjects API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/locations-api/>Locations API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/public-assets-api/>Public Assets API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/tenancies-api/>Tenancies API</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/api-reference/caps-api/>Caps API</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#yaml-reference aria-expanded=false>
YAML Runner Reference</button><div class=collapse id=yaml-reference><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/story-runner-components/>YAML Runner Components</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/assets/>Assets YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/events/>Events YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/locations/>Locations YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/subjects/>Subjects YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/compliance/>Compliance Policies YAML Runner</a></li><li><a class="docs-link rounded" href=https://docs.datatrails.ai/developers/yaml-reference/estate-info/>Estate Information YAML Runner</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#environment-configuration>Environment Configuration</a></li><li><a href=#each-log-is-comprised-of-many-massif-blobs-each-containing-a-fixed-number-of-leaves>Each Log Is Comprised of Many Massif Blobs, Each Containing a Fixed Number of Leaves</a></li><li><a href=#every-massif-blob-is-a-series-of-32-byte-aligned-fields>Every Massif Blob Is a Series of 32 Byte Aligned Fields</a></li><li><a href=#re-creating-inclusion-proofs-requires-only-one-massif>Re-Creating Inclusion Proofs Requires Only One Massif</a></li><li><a href=#the-first-32-byte-field-in-every-massif-is-the-sequencing-header>The First 32 Byte Field in Every Massif Is the Sequencing Header</a><ul><li><a href=#decoding-an-idtimestamp>Decoding an idtimestamp</a></li></ul></li><li><a href=#the-triedata-entries-are-512-bits-each-and-are-formed-from-two-fields>The trieData entries are 512 bits each and are formed from two fields</a></li><li><a href=#the-peak-stack-and-mmr-data-sizes-are-computable>The Peak Stack and MMR Data Sizes Are Computable</a></li><li><a href=#the-massif-height-is-constant-for-all-blobs-in-a-log-configuration>The Massif Height Is Constant for All Blobs in a Log Configuration</a></li><li><a href=#reading-a-specific-mmr-node-by-mmrindex>Reading a Specific MMR Node by mmrindex</a></li><li><a href=#leaf-nodes-created-by-hashing-event-data>Leaf Nodes Created by Hashing Event Data</a></li><li><a href=#which-nodes>Which Nodes</a></li><li><a href=#tree-layout-in-storage>Tree Layout in Storage</a></li><li><a href=#visualizing-the-look-back-peak-stack>Visualizing the “Look Back” Peak Stack</a></li><li><a href=#how-the-tree-spans-the-massifs>How the Tree Spans the Massifs</a><ul><li><a href=#massif-0>Massif 0</a></li><li><a href=#massif-1>Massif 1</a></li><li><a href=#massif-2>Massif 2</a></li><li><a href=#massif-3>massif 3</a></li><li><a href=#massif-4>Massif 4</a></li></ul></li><li><a href=#takeaways>Takeaways</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://docs.datatrails.ai/>Home</a></li><li class=breadcrumb-item><a href=https://docs.datatrails.ai/developers/>Developers</a></li><li class=breadcrumb-item><a href=https://docs.datatrails.ai/developers/developer-patterns/>Developer Patterns</a></li><li class="breadcrumb-item active" aria-current=page>Navigating the Merkle Log</li></ol></nav><div class=my-n3></div><h1>Navigating the Merkle Log</h1><p class=lead>Accessing the data needed to verify from first principals</p><p>This article explains how to navigate the Merkle Log, using the DataTrails Merkle Mountain Range implementation.</p><p>DataTrails publishes the data necessary for immediately verifying events to highly available commodity cloud storage.
&ldquo;Verifiable data&rdquo; is synonymous with <em>log</em> or <em>transparency log</em>.
Once verifiable data is written to the log it is never changed.
The log only grows, it never shrinks and data in it never moves within the log.</p><p>To work with Merkle Log format, DataTrails provides
<a href=https://github.com/datatrails/veracity/ target=_blank rel=noopener>open-source tooling</a> for working in offline environments.</p><p>To verify DataTrails logs, you will need:</p><ol><li>A copy of the section of the log containing your event, (or the url to the
publicly available log data)</li><li>A copy of any log <em>seal</em> from <em>any</em> time after your event was included</li><li>A copy of any events you wish to verify are included within the log</li><li>A Tenant ID to run the samples</li></ol><p>For reference:</p><ul><li>DataTrails log implementation:
<a href=https://github.com/datatrails/go-datatrails-merklelog target=_blank rel=noopener>go-datatrails-merklelog</a>.</li><li>Examples for verification:
<a href=https://github.com/datatrails/go-datatrails-demos/ target=_blank rel=noopener>go-datatrails-demos</a></li><li>Log inclusion and introspection:
<a href=https://github.com/datatrails/veracity/blob/main/README.md target=_blank rel=noopener>veracity</a></li></ul><p>To reproduce these examples from first principals, using only the raw verifiable data structure, an understanding of the log format is provided by this article.</p><p>If you already know the basics, and want a straight forward way to deal with the dynamically sized portions of the format, please see
<a href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables>Massif Blob Pre-Calculated Offsets</a></p><h2 id=environment-configuration>Environment Configuration<a href=#environment-configuration class=anchor aria-hidden=true>#</a></h2><p>DataTrails operates customer specific Tenants, and a single public tenant.</p><ul><li><p><strong>Public events</strong> are shared on the DataTrails public tenant.</p></li><li><p><strong>Protected events</strong> are only visible to the tenant owner, but the commitment (hash) in the log is public.</p></li></ul><p>The examples in this article use a DataTrail&rsquo;s Synsation demo tenant&rsquo;s to represent protected events.</p><p>To view <em>your</em> protected events, replace <code>TENANT</code> with your <code>Tenant ID</code>.</p><p>Within the
<a href=https://app.datatrails.ai target=_blank rel=noopener>DataTrails app</a>, click the top/right corner, selecting copy Tenancy Identity.<figure class=border-0><input type=image data-bs-toggle=modal data-bs-target=#CopyTenancyIdentity img class="img-fluid responsive" src=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity.png width=432 height=282 data-sizes=auto data-srcset="https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_200x0_resize_box_3.png 200w" alt=Rectangle><noscript><img class=img-fluid sizes=100vw srcset="https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_200x0_resize_box_3.png 200w" src=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity.png width=432 height=282 alt=Rectangle></noscript><figcaption class=figure-caption><em>Copy Tenant ID</em></figcaption></figure><div class="modal fade" id=CopyTenancyIdentity tabindex=-1 aria-labelledby=CopyTenancyIdentity aria-hidden=true><div class="modal-dialog modal-xl"><div class=modal-body><img class="img-fluid lazyload responsive" data-sizes=auto src=https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_100x0_resize_box_3.png data-srcset="https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_900x0_resize_box_3.png 900w,https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_800x0_resize_box_3.png 800w,https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_500x0_resize_box_3.png 500w,https://docs.datatrails.ai/developers/developer-patterns/navigating-merklelogs/CopyTenancyIdentity_huacdf2ad3fd63ebf282aaf6b1948a9a1c_30713_200x0_resize_box_3.png 200w" width=432 height=282 alt=Rectangle></div></div></div></p><p>Update the variables to fit your environment:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># DataTrails Public Tenant</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PUBLIC_TENANT</span><span class=o>=</span><span class=s2>&#34;6ea5cd00-c711-3649-6914-7b125928bbb4&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Synsation Demo Tenant</span>
</span></span><span class=line><span class=cl><span class=c1># Replace to view your Tenant logs ane events</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TENANT</span><span class=o>=</span><span class=s2>&#34;6a009b40-eb55-4159-81f0-69024f89f53c&#34;</span>
</span></span></code></pre></div><h2 id=each-log-is-comprised-of-many-massif-blobs-each-containing-a-fixed-number-of-leaves>Each Log Is Comprised of Many Massif Blobs, Each Containing a Fixed Number of Leaves<a href=#each-log-is-comprised-of-many-massif-blobs-each-containing-a-fixed-number-of-leaves class=anchor aria-hidden=true>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+-----------+ +-----------+ .. +----------+
</span></span><span class=line><span class=cl>| massif 0  | | massif 1  |    | massif n
</span></span><span class=line><span class=cl>+-----------+ +-----------+ .. +----------+
</span></span></code></pre></div><blockquote><p>Illustration demonstrating the last massif is always in the process of being <em>appended</em> to</p></blockquote><p>What is a massif?
In this context, a massif means a
<a href=https://www.oxfordlearnersdictionaries.com/definition/american_english/massif target=_blank rel=noopener>group of mountains that form a large mass</a>.
Massif originates from the verifiable data structure used in the Merkle Mountain Range <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> (MMR) based log.</p><p>Merkle Mountain Ranges are attributed to
<a href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2016-May/012715.html target=_blank rel=noopener>Peter Todd</a>, though much parallel invention has occurred.
The &ldquo;post order&rdquo;, write once & append only nature of the tree organization was first discussed in 3.3 of the
<a href=https://static.usenix.org/event/sec09/tech/full_papers/crosby.pdf target=_blank rel=noopener>Crosby, Wallach paper</a>.
They have been independently analyzed in the context of
<a href=https://eprint.iacr.org/2015/718.pdf target=_blank rel=noopener>cryptographic asynchronous accumulators</a>, Generalized multi-proofs for
<a href=https://eprint.iacr.org/2021/038.pdf target=_blank rel=noopener>Binary Numeral Trees</a>.
And also by the
<a href=https://ethresear.ch/t/batching-and-cyclic-partitioning-of-logs/536 target=_blank rel=noopener>ethereum research community</a>.</p><p>Each massif contains the verifiable data for a fixed number, and sequential range, of events.
The number of events is determined by the log configuration parameter <code>massif height</code>.
Within DataTrails, all logs currently have a massif height of <code>14</code>, and the number of event <em>leaf</em> log entries in each massif is 2<sup>height-1</sup>, which is 2<sup>14-1</sup> leaves, which is <code>8192</code> leaves.
<code>14</code> was chosen as it affords a massif storage size of comfortably under 4mb (less than 2 actually), and for many situations it is practical to handle this size as &ldquo;one lump&rdquo;.
See
<a href=#the-massif-height-is-constant-for-all-blobs-in-a-log-configuration>reconfiguration</a> for more info.</p><p><a href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables>Massif Blob Pre-Calculated Offsets</a> provides a shortcut for picking the right massif.
It can also be fairly easily computed from only the <code>merklelog_entry.commit.index</code> <em>mmrIndex</em> on the event using the
<a href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables#the-algorithms-backing-the-table-generation>example javascript</a>.</p><h2 id=every-massif-blob-is-a-series-of-32-byte-aligned-fields>Every Massif Blob Is a Series of 32 Byte Aligned Fields<a href=#every-massif-blob-is-a-series-of-32-byte-aligned-fields class=anchor aria-hidden=true>#</a></h2><p>Every massif in a log is structured as a series of <code>32</code> byte fields.
All individual entries in the log are either 32 bytes or a small multiple of <code>32</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>  0               32
</span></span><span class=line><span class=cl>  +----------------+
</span></span><span class=line><span class=cl>  |                | field 0
</span></span><span class=line><span class=cl>  +----------------+
</span></span><span class=line><span class=cl>  .                .
</span></span><span class=line><span class=cl>  .                .
</span></span><span class=line><span class=cl>  +----------------+
</span></span><span class=line><span class=cl>  |                | field n
</span></span><span class=line><span class=cl>  +----------------+
</span></span></code></pre></div><p>Recalling our configuration (above), the tenants first massif blob can be found at:</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patternsnavigating-merklelogs-1 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patternsnavigating-merklelogs-1-0 type=button role=tab aria-controls=tabset-developersdeveloper-patternsnavigating-merklelogs-1-0 aria-selected=true>bash</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patternsnavigating-merklelogs-1><div id=tabset-developersdeveloper-patternsnavigating-merklelogs-1-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patternsnavigating-merklelogs-1-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl https://app.datatrails.ai/verifiabledata/merklelogs/v1/mmrs/tenant/<span class=nv>$TENANT</span>/0/massifs/0000000000000000.log -o 0.log
</span></span></code></pre></div></div></div><p>Each massif is stored in a numbered file.
The filename (<code>0000000000000000.log</code>) is the 16-character, zero-padded, massif index.</p><p>The DataTrails attestation for each massif can be found at a closely associated url.</p><p>For the massif above it is:<br><ul class="nav nav-tabs" id=tabset-developersdeveloper-patternsnavigating-merklelogs-2 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patternsnavigating-merklelogs-2-0 type=button role=tab aria-controls=tabset-developersdeveloper-patternsnavigating-merklelogs-2-0 aria-selected=true>bash</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patternsnavigating-merklelogs-2><div id=tabset-developersdeveloper-patternsnavigating-merklelogs-2-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patternsnavigating-merklelogs-2-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl https://app.datatrails.ai/verifiabledata/merklelogs/v1/mmrs/tenant/<span class=nv>$TENANT</span>/0/massifseals/0000000000000000.sth -o 0.sth
</span></span></code></pre></div></div></div></p><p>This is a simple reverse proxy to the native azure blob store where your logs are store.
The full
<a href=https://learn.microsoft.com/en-us/rest/api/azure/ target=_blank rel=noopener>Azure REST API</a> provides getting specific massif blobs.
For reasons of cost, all operations are subject to rate limits, listing blobs is not possible, though filtering blobs by tags is permitted.
Both the massif blobs and the log seal blobs are always tagged with the most recent idtimestamp for the log.
In the case of the masssif blobs, it is the idtimestamp most recently added to the log. In the case of the seal blob it is the most recent log entry that has been attested by DataTrails. The tag name is <code>lastid</code></p><h2 id=re-creating-inclusion-proofs-requires-only-one-massif>Re-Creating Inclusion Proofs Requires Only One Massif<a href=#re-creating-inclusion-proofs-requires-only-one-massif class=anchor aria-hidden=true>#</a></h2><p>The variable section of the massif blob is further split into the <em>accumulator</em> for the preceding log state followed by the regular massif nodes:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+----------------+----------------+
</span></span><span class=line><span class=cl>| FIXED          | HEADER DATA    |
</span></span><span class=line><span class=cl>|                +----------------+  fixed size
</span></span><span class=line><span class=cl>|        SIZE    | TRIE-DATA      |  pre-filled with zeros, populated as leaves are added
</span></span><span class=line><span class=cl>+----------------+----------------+
</span></span><span class=line><span class=cl>| VARIABLE       | PEAK           |  accumulator succinctly committing the entire preceding log state,
</span></span><span class=line><span class=cl>|                |         STACK  |    which is write once on massif create
</span></span><span class=line><span class=cl>|   write once   +----------------+
</span></span><span class=line><span class=cl>|                | MMR            | grows until 2^(height-1) leaves are added
</span></span><span class=line><span class=cl>.                .   NODES        |
</span></span><span class=line><span class=cl>.   APPEND ONLY  .                |
</span></span><span class=line><span class=cl>+----------------+----------------+
</span></span></code></pre></div><p>The accumulator is more precisely a cryptographic, asynchronous, accumulator whose properties are formally defined in this
<a href=https://eprint.iacr.org/2015/718.pdf target=_blank rel=noopener>paper</a>.
We refer to it as the peak stack due to how we maintain it and the fact that it is composed exclusively of &ldquo;peak&rdquo; nodes taken from the preceding log.</p><p>DataTrails provides convenience look up tables for
<a href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables>Massif Blob Pre-Calculated Offsets</a>, and implementations of the algorithms needed to produce those tables in many languages under an MIT license.</p><h2 id=the-first-32-byte-field-in-every-massif-is-the-sequencing-header>The First 32 Byte Field in Every Massif Is the Sequencing Header<a href=#the-first-32-byte-field-in-every-massif-is-the-sequencing-header class=anchor aria-hidden=true>#</a></h2><p>The following curl command reads the version and format information from the header field <code>0</code></p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patternsnavigating-merklelogs-3 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patternsnavigating-merklelogs-3-0 type=button role=tab aria-controls=tabset-developersdeveloper-patternsnavigating-merklelogs-3-0 aria-selected=true>bash</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patternsnavigating-merklelogs-3><div id=tabset-developersdeveloper-patternsnavigating-merklelogs-3-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patternsnavigating-merklelogs-3-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -s <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;Range: bytes=0-31&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;x-ms-blob-type: BlockBlob&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;x-ms-version: 2019-12-12&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  https://app.datatrails.ai/verifiabledata/merklelogs/v1/mmrs/tenant/<span class=nv>$TENANT</span>/0/massifs/0000000000000000.log <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=p>|</span> od -An -tx1 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=p>|</span> tr -d <span class=s1>&#39; \n&#39;</span>
</span></span></code></pre></div><p>generates a version information, similar to:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>00000000000000009148fda07f06640000000000000000000000010e00000000
</span></span></code></pre></div></div></div><blockquote class="note callout"><div><strong></strong> The request requires no authentication or authorization.</div></blockquote><p>The structure of the header field is:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>| type| idtimestamp| reserved |  version | epoch  |massif height| massif i |
</span></span><span class=line><span class=cl>| 0   | 8        15|          |  21 - 22 | 23   26|27         27| 28 -  31 | start and end byte indices, closed range
</span></span><span class=line><span class=cl>| 1   |     8      |          |      2   |    4   |      1      |     4    | count of bytes
</span></span></code></pre></div><p>The <code>idtimestamp</code> of the last leaf entry added to the log is always set in the header field.</p><p>In the hex data above, the <code>idtimestamp</code> of the last entry in the log is <code>9148fcc832066400</code><sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, the version is <code>0</code>, the timestamp epoch is <code>1</code>, the massif height is <code>14</code>, and the massif index is <code>0</code>.</p><h3 id=decoding-an-idtimestamp>Decoding an idtimestamp<a href=#decoding-an-idtimestamp class=anchor aria-hidden=true>#</a></h3><p>The <code>idtimestamp</code> is 40 bits of time at millisecond precision.
The <code>idtimestamp</code> in the header field is always set to the <code>idtimestamp</code> of the most recently added leaf.</p><p>The following examples depend on a python environment:</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patternsnavigating-merklelogs-4 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patternsnavigating-merklelogs-4-0 type=button role=tab aria-controls=tabset-developersdeveloper-patternsnavigating-merklelogs-4-0 aria-selected=true>Python</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patternsnavigating-merklelogs-4><div id=tabset-developersdeveloper-patternsnavigating-merklelogs-4-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patternsnavigating-merklelogs-4-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>idtimestamp_to_date</span><span class=p>(</span><span class=nb>id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Safely convert an idtimestamp hex string to a regular date time&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># ignore the common &#39;0x&#39; prefix</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nb>id</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;0x&#34;</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=nb>id</span> <span class=o>=</span> <span class=nb>id</span><span class=p>[</span><span class=mi>2</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>id</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>18</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;idtimestamp must be 18 or 16 hex chars&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>epoch</span> <span class=o>=</span> <span class=mi>1</span> <span class=c1># the epochs are aligned with the unix epoch but are half as long</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>id</span><span class=p>)</span> <span class=o>==</span> <span class=mi>18</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>epoch</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>id</span><span class=p>[:</span><span class=mi>2</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=nb>id</span> <span class=o>=</span> <span class=nb>id</span><span class=p>[</span><span class=mi>2</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nb>id</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>16</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;idtimestamp must be 18 or 16 hex chars&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># To get the time portion we strip the trailing sequence and generator id</span>
</span></span><span class=line><span class=cl>    <span class=n>unixms</span><span class=o>=</span><span class=nb>int</span><span class=p>((</span>
</span></span><span class=line><span class=cl>        <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>id</span><span class=p>)[:</span><span class=o>-</span><span class=mi>3</span><span class=p>])</span><span class=o>.</span><span class=n>hex</span><span class=p>(),</span> <span class=n>base</span><span class=o>=</span><span class=mi>16</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span> <span class=o>+</span> <span class=n>epoch</span><span class=o>*</span><span class=p>((</span><span class=mi>2</span><span class=o>**</span><span class=mi>40</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>fromtimestamp</span><span class=p>(</span><span class=n>unixms</span><span class=o>/</span><span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>idtimestamp_to_date</span><span class=p>(</span><span class=s1>&#39;9148fcc832066400&#39;</span><span class=p>))</span>
</span></span></code></pre></div><p>Generates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2024-08-13 00:46:51.569000
</span></span></code></pre></div></div></div><p>In this example, the last entry in the log (at that time) was <code>2024/08/13</code>, a little before 1am UTC.</p><h2 id=the-triedata-entries-are-512-bits-each-and-are-formed-from-two-fields>The trieData entries are 512 bits each and are formed from two fields<a href=#the-triedata-entries-are-512-bits-each-and-are-formed-from-two-fields class=anchor aria-hidden=true>#</a></h2><p>With the trie keys, full data recovery can be verified without needing to remember the order that events were added to the log.</p><p>Massifs can be recovered independently even if the data for other massifs is incomplete.</p><p>The index also provides for proof of exclusion. Proof that a specific event is not in the index.
As the event identities contribute to both the index keys and the leaf entries,
and as the keys are time ordered on addition, it is possible to audit the specific range.
This will confirm the log is consistent with the index for the time range in which the disputed item is claimed to exist.</p><p>The trieData section is 2 * 32 * 2<sup>height</sup> bytes long, which is exactly double what is needed.
For a standard massif height of 14, it has 8,192 entries in the first 524,288 bytes.
The subsequent 524,288 will always be zero.
The format of each entry is then, for a massif height of 14:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+----------------+
</span></span><span class=line><span class=cl>| HEADER DATA    |
</span></span><span class=line><span class=cl>+----------------+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>288
</span></span><span class=line><span class=cl>+----------------+
</span></span><span class=line><span class=cl>| TRIE-DATA      |
</span></span><span class=line><span class=cl>|                |
</span></span><span class=line><span class=cl>|                |
</span></span><span class=line><span class=cl>|................| 288 + 524288 = 524576
</span></span><span class=line><span class=cl>|  always        |
</span></span><span class=line><span class=cl>|                |
</span></span><span class=line><span class=cl>|       zero     |
</span></span><span class=line><span class=cl>+----------------+ 288 + 524288 * 2 = 1048864
</span></span></code></pre></div><p>Each entry is formatted like this</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0                                                        31
</span></span><span class=line><span class=cl>SHA256(BYTE(0x00) || tenant-identity || event.identity)
</span></span><span class=line><span class=cl>0                                       BYTES(IDTIMESTAMP)
</span></span><span class=line><span class=cl>32                                      56               63
</span></span></code></pre></div><p>Described in further detail in the
<a href=https://github.com/datatrails/go-datatrails-merklelog/blob/main/term-cheatsheet.md#trie-entry target=_blank rel=noopener>term-cheatsheet</a>
Note that the <code>idtimestamp</code> is unique to the tenant and the DataTrails service.
When sharing events with other tenants, the <code>idtimestamp</code> will not correlate directly with activity in other tenant logs.</p><p>When a massif is initialized the trieData is pre-populated for all leaves and set to all zero bytes.
As events are recorded in the log, the zero-padded index is filled in.
A sub-range of field 0 will change when saving the last <code>idtimestamp</code> in it.
The MMR node values are strictly only ever appended to the blob.
Once appended they will never change and they will never move.</p><p>Returning to the trieData section, given an event identity of:</p><p><code>assets/20d6f57c-bce2-4be9-8e70-95ded25399b7/events/bbd934cb-a20f-44c9-aa5d-a3ce333c5208</code></p><p>The trieKey for the synsation tenant&rsquo;s log is:
<code>d273400cca0d594ddbd4f04bc9275e0e6d995da1accafa00b5be879a265ecda9</code></p><p>The following python snippet generates a trieKey from the event data to confirm what should be in the index at a specific position.</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patternsnavigating-merklelogs-5 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patternsnavigating-merklelogs-5-0 type=button role=tab aria-controls=tabset-developersdeveloper-patternsnavigating-merklelogs-5-0 aria-selected=true>Python</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patternsnavigating-merklelogs-5><div id=tabset-developersdeveloper-patternsnavigating-merklelogs-5-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patternsnavigating-merklelogs-5-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>TENANT</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s1>&#39;TENANT&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>PUBLIC_TENANT</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s1>&#39;PUBLIC_TENANT&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ASSET</span><span class=o>=</span><span class=s1>&#39;20d6f57c-bce2-4be9-8e70-95ded25399b7&#39;</span>
</span></span><span class=line><span class=cl><span class=n>EVENT</span><span class=o>=</span><span class=s1>&#39;bbd934cb-a20f-44c9-aa5d-a3ce333c5208&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>triekey</span><span class=p>(</span><span class=n>tenant</span><span class=p>,</span> <span class=n>event</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>tenant</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>event</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>h</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>triekey</span><span class=p>(</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;tenant/&#34;</span> <span class=o>+</span> <span class=n>TENANT</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;assets/&#34;</span> <span class=o>+</span> <span class=n>ASSET</span> <span class=o>+</span> <span class=s2>&#34;/events/&#34;</span> <span class=o>+</span> <span class=n>EVENT</span><span class=p>))</span>
</span></span></code></pre></div><p>generates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>d273400cca0d594ddbd4f04bc9275e0e6d995da1accafa00b5be879a265ecda9
</span></span></code></pre></div></div></div><p>The above example is an event on a public asset, so it can be found in the public tenant&rsquo;s merkle log.</p><p>Using the python requests object (or curl), fetch the public tenants log,</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patternsnavigating-merklelogs-6 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patternsnavigating-merklelogs-6-0 type=button role=tab aria-controls=tabset-developersdeveloper-patternsnavigating-merklelogs-6-0 aria-selected=true>Python</button></li><li class=nav-item><button data-bs-toggle=tab class=nav-link data-bs-target=#tabset-developersdeveloper-patternsnavigating-merklelogs-6-1 type=button role=tab aria-controls=tabset-developersdeveloper-patternsnavigating-merklelogs-6-1 aria-selected=false>Bash</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patternsnavigating-merklelogs-6><div id=tabset-developersdeveloper-patternsnavigating-merklelogs-6-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patternsnavigating-merklelogs-6-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>TENANT</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s1>&#39;TENANT&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://app.datatrails.ai/verifiabledata/merklelogs/v1/mmrs/tenant/&#39;</span><span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=n>TENANT</span><span class=o>+</span><span class=s1>&#39;/0/massifs/0000000000000000.log&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=n>headers</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;x-ms-blob-type&#34;</span><span class=p>:</span> <span class=s2>&#34;BlockBlob&#34;</span><span class=p>,</span> <span class=s2>&#34;x-ms-version&#34;</span><span class=p>:</span> <span class=s2>&#34;2019-12-12&#34;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;mmr.log&#34;</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span></code></pre></div></div><div id=tabset-developersdeveloper-patternsnavigating-merklelogs-6-1 class="tab-pane fade" role=tabpanel aria-labelledby=tabset-developersdeveloper-patternsnavigating-merklelogs-6-1><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -s <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;x-ms-blob-type: BlockBlob&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;x-ms-version: 2019-12-12&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  https://app.datatrails.ai/verifiabledata/merklelogs/v1/mmrs/tenant/<span class=nv>$TENANT</span>/0/massifs/0000000000000000.log -o mmr.log
</span></span></code></pre></div></div></div><p>Using python, we can more readily illustrate the 32 byte aligned format.</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patternsnavigating-merklelogs-7 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patternsnavigating-merklelogs-7-0 type=button role=tab aria-controls=tabset-developersdeveloper-patternsnavigating-merklelogs-7-0 aria-selected=true>Python</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patternsnavigating-merklelogs-7><div id=tabset-developersdeveloper-patternsnavigating-merklelogs-7-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patternsnavigating-merklelogs-7-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>binascii</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=n>SYNSATION_TENANT</span> <span class=o>=</span> <span class=s2>&#34;6a009b40-eb55-4159-81f0-69024f89f53c&#34;</span>
</span></span><span class=line><span class=cl><span class=n>TENANT</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;TENANT&#39;</span><span class=p>,</span> <span class=n>SYNSATION_TENANT</span><span class=p>)</span> <span class=c1># default to synsation if not in env </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>readfields</span><span class=p>(</span><span class=n>tenant</span><span class=p>,</span> <span class=n>log</span><span class=o>=</span><span class=s2>&#34;0000000000000000&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://app.datatrails.ai/verifiabledata/merklelogs/v1/mmrs/tenant/&#39;</span><span class=o>+</span><span class=n>tenant</span><span class=o>+</span><span class=s1>&#39;/0/massifs/&#39;</span><span class=o>+</span><span class=n>log</span><span class=o>+</span><span class=s1>&#39;.log&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>hex</span> <span class=o>=</span> <span class=n>binascii</span><span class=o>.</span><span class=n>hexlify</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>content</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nb>hex</span><span class=p>)</span> <span class=o>/</span> <span class=mi>64</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=nb>hex</span><span class=p>[</span><span class=n>i</span><span class=o>*</span><span class=mi>64</span><span class=p>:(</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=mi>64</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>log</span> <span class=o>=</span> <span class=s2>&#34;0000000000000000&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>field</span> <span class=ow>in</span> <span class=n>readfields</span><span class=p>(</span><span class=n>TENANT</span><span class=p>,</span> <span class=n>log</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>field</span><span class=p>)</span>
</span></span></code></pre></div><p>The first few fields will look like</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>00000000000000009148fda07f06640000000000000000000000010e00000000
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000000000000000000000
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000000000000000000000
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000000000000000000000
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000000000000000000000
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000000000000000000000
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000000000000000000000
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000000000000000000000
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000000000000000000000
</span></span><span class=line><span class=cl>d273400cca0d594ddbd4f04bc9275e0e6d995da1accafa00b5be879a265ecda9
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000009148fcc832066400
</span></span><span class=line><span class=cl>f67192c6a4fe6a3454000225647deb37e7c488461b1d52f8d1dc58222d49d4db
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000009148fccedb045d00
</span></span><span class=line><span class=cl>1057b8d9caaf1f09e46e04a4e36295276fa8f2ef676144f4b90fc47e335ea51e
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000009148fd0d47066400
</span></span><span class=line><span class=cl>7fe0c5553a639bbeb5e0c26e24c94722f126fa258560097c531e9eb12e12dc88
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000009148fd52e7066400
</span></span><span class=line><span class=cl>0e561df1aa165967ffe12b0d84491e29349d0022f840d9dcb5bb3fe62551ef5c
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000009148fda07f066400
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000000000000000000000
</span></span><span class=line><span class=cl>0000000000000000000000000000000000000000000000000000000000000000
</span></span></code></pre></div></div></div><p>Note the trieKey we derived earlier is easily spotted at row 9, and its
<code>idtimestamp</code>, <code>9148fcc832066400</code>, is in the subsequent field</p><p>All public events are automatically shared to the public tenant. This makes the
event data visible without access control. The example event we created in the
Synsation tenant is a public event. We can obtain its corresponding entry in the
log by deriving its trieKey, and recalling our implementation for <code>triekey</code> above</p><p>Obtain the trie key for the public tenant event:</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patternsnavigating-merklelogs-8 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patternsnavigating-merklelogs-8-0 type=button role=tab aria-controls=tabset-developersdeveloper-patternsnavigating-merklelogs-8-0 aria-selected=true>Python</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patternsnavigating-merklelogs-8><div id=tabset-developersdeveloper-patternsnavigating-merklelogs-8-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patternsnavigating-merklelogs-8-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>TENANT</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s1>&#39;TENANT&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>PUBLIC_TENANT</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s1>&#39;PUBLIC_TENANT&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>ASSET</span><span class=o>=</span><span class=s1>&#39;20d6f57c-bce2-4be9-8e70-95ded25399b7&#39;</span>
</span></span><span class=line><span class=cl><span class=n>EVENT</span><span class=o>=</span><span class=s1>&#39;bbd934cb-a20f-44c9-aa5d-a3ce333c5208&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>triekey</span><span class=p>(</span><span class=n>tenant</span><span class=p>,</span> <span class=n>event</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=nb>bytes</span><span class=p>([</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>tenant</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>event</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>h</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>triekey</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;tenant/&#34;</span> <span class=o>+</span> <span class=n>PUBLIC_TENANT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;assets/&#34;</span> <span class=o>+</span> <span class=n>ASSET</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;/events/&#34;</span> <span class=o>+</span> <span class=n>EVENT</span><span class=p>))</span>
</span></span></code></pre></div><p>Generates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>c31114a64b9dca1376d7af999d35b4fa05a75965cb49d2b58386e19b8bbc73a9
</span></span></code></pre></div></div></div><p>If you similarly run <code>getlog</code> (from the example above) on the public tenant, the public trieKey is found
at line 2390. As this log commits events shared from many tenants, the MMRIndex
of the publicly committed event is different (and quite a lot higher)</p><p>The full details of the publicly available event can be found
<a href="https://app.datatrails.ai/merklelogentry/20d6f57c-bce2-4be9-8e70-95ded25399b7/bbd934cb-a20f-44c9-aa5d-a3ce333c5208?public=true" target=_blank rel=noopener>here</a></p><p>Noting that the <code>public</code> routing prefix is not prepended on the event identity.</p><p>This works the same for regular OBAC shares, a shared event is committed both to
the originating tenants log and to the recipient tenants log.</p><p>It is not possible to directly correlate activity between different tenants logs unless you know both the tenant identity and the event identity.
For permissioned events, this will only be available if the executing identity is included in the sharing policy.
The <code>idtimestamp</code> is different for each log, guaranteed unique within the context of a single log, and, assuming only good operation of our cloud providers clocks, guaranteed unique system wide.</p><p>It is important to remember that timing analysis is possible regardless of whether we have trie keys or not.</p><h2 id=the-peak-stack-and-mmr-data-sizes-are-computable>The Peak Stack and MMR Data Sizes Are Computable<a href=#the-peak-stack-and-mmr-data-sizes-are-computable class=anchor aria-hidden=true>#</a></h2><p>See
<a href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables>Massif Blob Pre-Calculated Offsets</a> to avoid needing to calculate these.
Implementations of the O(log base 2 n) algorithms are provided in various languages.
They all have very hardware-sympathetic implementations.</p><h2 id=the-massif-height-is-constant-for-all-blobs-in-a-log-configuration>The Massif Height Is Constant for All Blobs in a Log Configuration<a href=#the-massif-height-is-constant-for-all-blobs-in-a-log-configuration class=anchor aria-hidden=true>#</a></h2><p>For a massif height of <code>14</code>, the fixed size portion is <code>1048864</code> bytes.</p><p>A typical url for a massif storage blob looks like:<br><code>https://app.datatrails.ai/verifiabledata/merklelogs/v1/mmrs/tenant/6ea5cd00-c711-3649-6914-7b125928bbb4/0/massifs/0000000000000000.log</code></p><p>In the above, the <em>log configuration</em> identifier is the <code>/0/</code> between the tenant uuid and the <code>massifs/0000000000000000.log</code></p><p>The massif height is recorded at the start record of every massif, and guarantees that all massifs in a single configuration path have the same <strong>massif height</strong>.</p><p>Currently all DataTrails tenants use the same configuration.
In the future, DataTrails may change the height for massifs.
In a log reconfiguration activity, DataTrails would first publish the tail of the log to the new path. For example: (<code>/1/massifs/0000000000000123.log</code>).
The log would be immediately available for continued growth.
The historic configuration continues to be available under the <code>/0/</code> path.
Depending on data retention and migration policies for your tenant, the historic configuration can verifiably be migrated to the new path without interrupting service or availability.</p><p>This is achieved without impacting the verifiability of the contained data and without invalidating your previously cached copies taken from the earlier massif size configuration.
If reconfigured, a log configuration description will also be published along side the massifs and seals.</p><p>Simple binary file compare operations can show that the verifiable data for the new configuration is the same as in the original should you wish to assure yourself of this fact.</p><p>The previous configuration path will no longer receive any additions.</p><blockquote class="note callout"><div><strong></strong> For the forseeable future (at least months) DataTrails does not anticipate needing to reconfigure the massif height.</div></blockquote><h2 id=reading-a-specific-mmr-node-by-mmrindex>Reading a Specific MMR Node by mmrindex<a href=#reading-a-specific-mmr-node-by-mmrindex class=anchor aria-hidden=true>#</a></h2><p>The variable portion <em>for the first massif</em> contains exactly <em>16383</em> MMR <em>nodes</em>.
Of those nodes, <em>8192</em> are the leaf entries in the Merkle tree corresponding to your events.</p><p>Given a byte offset in the blob for the start of the MMR data, a query can check for the number of MMR nodes currently in it by doing <code>(blobSize - mmrDataStart)/32</code>.</p><p>To read a specific MMR node, find the smallest <code>Last Node</code> in
<a href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables>Massif Blob Pre-Calculated Offsets</a> that is greater than your <em>mmrIndex</em> and use that row as your massif index.</p><p>Taking the massif index of 0 (row 0) use the first mmrIndex:</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patternsnavigating-merklelogs-9 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patternsnavigating-merklelogs-9-0 type=button role=tab aria-controls=tabset-developersdeveloper-patternsnavigating-merklelogs-9-0 aria-selected=true>Bash</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patternsnavigating-merklelogs-9><div id=tabset-developersdeveloper-patternsnavigating-merklelogs-9-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patternsnavigating-merklelogs-9-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>LOGSTART</span><span class=o>=</span><span class=m>1048864</span>
</span></span><span class=line><span class=cl><span class=nv>MMRINDEX</span><span class=o>=</span><span class=m>2376</span>
</span></span><span class=line><span class=cl>curl -s <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;Range: bytes=</span><span class=k>$((</span><span class=nv>$LOGSTART</span><span class=o>+</span><span class=nv>$MMRINDEX</span><span class=o>*</span><span class=m>32</span><span class=k>))</span><span class=s2>-</span><span class=k>$((</span><span class=nv>$LOGSTART</span><span class=o>+</span><span class=nv>$MMRINDEX</span><span class=o>*</span><span class=m>32</span><span class=o>+</span><span class=m>31</span><span class=k>))</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;x-ms-blob-type: BlockBlob&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;x-ms-version: 2019-12-12&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  https://app.datatrails.ai/verifiabledata/merklelogs/v1/mmrs/tenant/<span class=nv>$PUBLIC_TENANT</span>/0/massifs/0000000000000000.log  <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=p>|</span> od -An -tx1 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=p>|</span> tr -d <span class=s1>&#39; \n&#39;</span>
</span></span></code></pre></div><p>Generates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>3cab877bc730f7e3d652e74b5b9e9a3fad605001c29ebe481764d184c7773f95
</span></span></code></pre></div></div></div><p>You can confirm this on the merklelog
<a href="https://app.datatrails.ai/merklelogentry/20d6f57c-bce2-4be9-8e70-95ded25399b7/861dd529-3616-4ad2-b2a9-702da77b8588?public=true" target=_blank rel=noopener>page</a> in the public tenant for this event. Look for the &ldquo;Merkle Leaf&rdquo; field.</p><p>Optionally use
<a href=https://github.com/datatrails/veracity/ target=_blank rel=noopener>veracity</a> to confirm:</p><ul class="nav nav-tabs" id=tabset-developersdeveloper-patternsnavigating-merklelogs-10 role=tablist><li class=nav-item><button data-bs-toggle=tab class="nav-link active" data-bs-target=#tabset-developersdeveloper-patternsnavigating-merklelogs-10-0 type=button role=tab aria-controls=tabset-developersdeveloper-patternsnavigating-merklelogs-10-0 aria-selected=true>bash</button></li></ul><div class=tab-content id=tabset-developersdeveloper-patternsnavigating-merklelogs-10><div id=tabset-developersdeveloper-patternsnavigating-merklelogs-10-0 class="tab-pane fade show active" role=tabpanel aria-labelledby=tabset-developersdeveloper-patternsnavigating-merklelogs-10-0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>veracity <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--data-url <span class=s2>&#34;https://app.datatrails.ai/verifiabledata&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-t tenant/<span class=nv>$PUBLIC_TENANT</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>node -i <span class=m>2376</span>
</span></span></code></pre></div><p>Generates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>3cab877bc730f7e3d652e74b5b9e9a3fad605001c29ebe481764d184c7773f95
</span></span></code></pre></div></div></div><p>The example javascript in
<a href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables#the-algorithms-backing-the-table-generation>Massif Blob Pre-Calculated Offsets</a> can be used to accomplish this computationally.</p><h2 id=leaf-nodes-created-by-hashing-event-data>Leaf Nodes Created by Hashing Event Data<a href=#leaf-nodes-created-by-hashing-event-data class=anchor aria-hidden=true>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0                                                        31
</span></span><span class=line><span class=cl>SHA256(BYTE(0x00) || BYTES(IDTIMESTAMP) || V3-SCHEMA(event))
</span></span></code></pre></div><p>The V3 Schema defines how the content on your event is consistently converted to bytes prior to hashing.
This works by passing the fields specified in the schema through the
<a href=https://en.wikipedia.org/wiki/Bencode target=_blank rel=noopener>bencode</a> encoding system.</p><p>See our knowledge base
<a href=https://support.datatrails.ai/hc/en-gb/articles/18120936244370-How-to-independently-verify-Merkle-Log-Events-recorded-on-the-DataTrails-transparency-ledger#h_01HTYDD6ZH0FV2K95D61RQ61ZJ target=_blank rel=noopener>article</a> for an example in javascript and the definition of the V3 fields.</p><p>Note that this includes the <code>event_identity</code> and <code>tenant_identity</code> which are also included in the trieKey hash.</p><p>The remaining item is conditioning the <code>IDTIMESTAMP</code> for hashing.
If you have the event record from the Events API, the idtimestamp is found at <code>merklelog_entry.commit.idtimestamp</code>.
It is a hex string and prefixed with <code>01</code> which is the epoch from the header.</p><p>To condition the string value, strip the leading <code>01</code> and convert the remaining hex to binary.
Then substitute those bytes, in presentation order, for idTimestamp above.</p><p>The bytes for the hash are just <code>bytes.fromhex("019148fccdbf066400"[2:])</code></p><p>You can use the earlier python example to convert this format to a regular date time.</p><h2 id=which-nodes>Which Nodes<a href=#which-nodes class=anchor aria-hidden=true>#</a></h2><p>Typically, verifiers would verify the inclusion of an event in the log.
The inclusion is verified by selecting the sibling path needed to recreate the root hash starting from your leaf hash.
Create the leaf hash using the original pre-image data of your event and the <em>commit</em> values assigned to it when it was included in the log.</p><p>For example:</p><ul><li>The V3 canonical set of fields from your event (as described in our knowledge base
<a href=https://support.datatrails.ai/hc/en-gb/articles/18120936244370-How-to-independently-verify-Merkle-Log-Events-recorded-on-the-DataTrails-transparency-ledger#h_01HTYDD6ZH0FV2K95D61RQ61ZJ target=_blank rel=noopener>article</a>)</li><li>The <code>merklelog_entry.commit.index</code> (the mmrIndex of the event in the log)</li><li>The <code>merklelog_entry.commit.idtimestamp</code> uniquely placing the record of the log in time (according to our cloud service provider)</li></ul><p>Determining the sibling path will be a future article.
First, set the scene by covering how the logical tree nodes map to storage.</p><p>What is a sibling path?
To understand this we need to dig into how DataTrails organizes the nodes in the Merkle log in storage and memory.</p><h2 id=tree-layout-in-storage>Tree Layout in Storage<a href=#tree-layout-in-storage class=anchor aria-hidden=true>#</a></h2><p>Merkle trees <em>prove</em> things by providing paths of hashes that lead to a single <em>common root</em> for all nodes in the tree.
For an MMR, a single root can be produced by &ldquo;bagging the peaks&rdquo;.
But the list of peaks, from which that single root is produced, is itself precisely determined by the size of the MMR.
Having the peak list is equivalent to having a single root.
And having a path that leads to a peak is equivalent to having a path to a single root
The peak list is an accumulator state and a path to an accumulator is actually more useful.</p><p>The formal details, and a very nice visualization of how the peaks combine, is available in this paper on
<a href=https://eprint.iacr.org/2015/718.pdf target=_blank rel=noopener>cryptographic, asynchronous, accumulators</a> (see Fig 4, page 12)</p><p>The peaks are exactly the accumulator described there.</p><p>All entries in a Merkle log each have a unique and <em>short</em> path of hashes<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>: , which when hashed together according to the data structures rules, will re-create the same root.
If such a path does not exist, by definition the leaf is not included - it is not in the log.</p><p>Where do those paths come from?
They come from adjacent and ancestor nodes in the hierarchical tree.
This means that when producing the path we need to access nodes throughout the tree to produce the proof.</p><p>Using the &ldquo;canonical&rdquo; MMR log for illustration, we get this diagram.
The vertical axis is labeled by height index, which is just height - 1.
The connecting diagonal dashes above the &ldquo;tree line&rdquo; indicate nodes that belong to one massif but depend on peaks accumulated from earlier massifs.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>                          
</span></span><span class=line><span class=cl>                       14 
</span></span><span class=line><span class=cl>                          \        affectionately called the alpine zone
</span></span><span class=line><span class=cl>                6           13             21   
</span></span><span class=line><span class=cl>                  \            \              \
</span></span><span class=line><span class=cl>    h=2 1 |  2  |  5  |   9  |  12   |  17   | 20  | -- massif &#39;tree line&#39;
</span></span><span class=line><span class=cl>          |     |     |      |       |       |     |
</span></span><span class=line><span class=cl>        0 |0   1| 3  4| 7   8|10   11|15   16|18 19|
</span></span></code></pre></div><p>The sibling <em>proof</em> path for the leaf with <code>mmrIndex</code> <code>7</code> would be [<code>8</code>, <code>12</code>, <code>6</code>], and the &ldquo;peak bagging&rdquo; algorithm may then be applied to get the root if that was desired.
An inclusion proof against an accumulator entry both equivalent and also more durable, as it is permanently consistent with all future accumulator states.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>H(7 || 8) = 9
</span></span><span class=line><span class=cl>H(9 || 12) = 13
</span></span><span class=line><span class=cl>H(6 || 13) = 14
</span></span></code></pre></div><p>14 is a peak in the MMR. The precise set of peaks are determined exclusively from the current mmr size which is 23 in this case. Showing a leaf has a path to a peak for the MMR is sufficient to prove its inclusion in the MMR.</p><h2 id=visualizing-the-look-back-peak-stack>Visualizing the “Look Back” Peak Stack<a href=#visualizing-the-look-back-peak-stack class=anchor aria-hidden=true>#</a></h2><p>A specific challenge for log implementations with very large data sets is answering &ldquo;how far back&rdquo; or &ldquo;how far forward&rdquo; may be seen?</p><p>MMRs differ from classic binary Merkle trees in how, or even <em>if</em>, the incomplete sub-trees are combined into a common root.
For an MMR, the common root is defined by an algorithm for combining the adjacent, incomplete sub-trees.
Rather than by the more traditional, temporary, assignment of un-balanced siblings.
Such un-balanced siblings would later have to be re-assigned (balanced) when there were sufficient leaves to merge the sub-trees.</p><p>While a single root can be produced for an MMR, due to the properties of the accumulator construction, there is much less value in doing so.
Typically, verification use cases are better served by paths to an accumulator.</p><p>The linear and write once nature of this storage organization is what permits DataTrails to publish the log data immediately after events are added.</p><p>The specific properties of Merkle Mountain Ranges lead to an efficiently computable and stable answer to the question of <em>&ldquo;Which other nodes do I need&rdquo;</em>.
Such that we <em>know</em> categorically it is not needed to look <em>forward</em> of the current massif and it is precisely known which nodes are needed from the previous massifs.</p><p>The &ldquo;free nodes&rdquo; in the alpine zone always require &ldquo;ancestors&rdquo; from previous nodes when producing inclusion proofs that pass through them, and when adding new nodes to the end of the log.
But those ancestors are precisely the peaks forming the accumulator that attests to the log state and provide efficient, permanently useful, proofs of inclusion and consistency.</p><p>The progression of the peak stack (accumulator) can be visualized like this. In this diagram we gather the dependent nodes into the massifs they belong too and carry forward the peak stack (accumulator) that fully authenticates the entire state of the MMR preceding the massif.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>      |[]   |[2]  |[6]   |[6,9]  |[14]   |[14,17]| peak stack
</span></span><span class=line><span class=cl>      |     |     |      |       |       |       |
</span></span><span class=line><span class=cl>      |     |6    |      |13, 14 |       |21     | spurs
</span></span><span class=line><span class=cl>      |     |     |      |       |       |       |
</span></span><span class=line><span class=cl>h=2 1 |  2  |  5  |   9  |  12   |  17   |  20   | &lt;-- massif height &#39;tree line&#39;
</span></span><span class=line><span class=cl>      |     |     |      |       |       |       |
</span></span><span class=line><span class=cl>    0 |0   1 3   4| 7   8|10   11|15   16|18   19|
</span></span></code></pre></div><p><em>Note: height is 1 based, height indices are 0 based. So at h=2 we have height index 1.</em></p><p>The log configuration parameter massif height is the &ldquo;tree line&rdquo;.
The first leaf addition that causes &ldquo;break out&rdquo; is the last leaf of that particular massif.
The &ldquo;break out nodes&rdquo; for the last leaf are stored in the same massif as the leaf.
While the leaf count for each massif is fixed, the number of nodes is variable.
The variance is deterministic given only the MMR size.</p><p>The look-back nodes are called the <em>peak stack</em> because the operations we use to maintain it are stack like.
Entries don&rsquo;t pop off, ever.
Entries just happen to reference it in reverse order of addition when adding new leaves.</p><p>The stability of the MMR data comes from the fact that the sub trees are not merged until a right sibling tree of equal height has been produced.
Merging is accomplished by <em>appending</em> the new parent immediately after the right sibling.
This means when merged, the sub trees do not change in content or organization, nodes are simply appended to commit them to the log.
This results in the &ldquo;write-once&rdquo; and &ldquo;append only&rdquo; properties discussed in the
<a href=https://static.usenix.org/event/sec09/tech/full_papers/crosby.pdf target=_blank rel=noopener>crosby-wallach</a> 3.3 &ldquo;Storing the log on secondary storage&rdquo;</p><h2 id=how-the-tree-spans-the-massifs>How the Tree Spans the Massifs<a href=#how-the-tree-spans-the-massifs class=anchor aria-hidden=true>#</a></h2><p>A worked example for a Merkle log whose height configuration parameter is set to 2.</p><h3 id=massif-0>Massif 0<a href=#massif-0 class=anchor aria-hidden=true>#</a></h3><p>The peak stack size is established for a massif when it is created in its empty state. The size is efficiently calculable from the MMR Index at the start of the new massif. For the first massif the stack will be empty.</p><p>When viewed horizontally, we start by denoting the empty stack like this.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>++
</span></span><span class=line><span class=cl>||
</span></span><span class=line><span class=cl>++
</span></span></code></pre></div><p>Then, the leaves for the complete MMR of size 3 from our canonical example are added after the peak stack.</p><p>This gives us the final form for massif 0 as:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>++---+---+---+
</span></span><span class=line><span class=cl>|| 0 | 1 | 2 |
</span></span><span class=line><span class=cl>++---+-------+
</span></span></code></pre></div><p>The massif has exactly 3 nodes</p><p>The peak stack is empty, and the global tree looks like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  1    2  | --- massif tree line massif height index = 1
</span></span><span class=line><span class=cl>      / \ |
</span></span><span class=line><span class=cl>     0   1| MMR INDICES
</span></span><span class=line><span class=cl>     -----|
</span></span><span class=line><span class=cl>       0  | MASSIF
</span></span></code></pre></div><h3 id=massif-1>Massif 1<a href=#massif-1 class=anchor aria-hidden=true>#</a></h3><p>Once massif 1 has been constructed, the global tree would be:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2       6       --- max height index = 2
</span></span><span class=line><span class=cl>         \
</span></span><span class=line><span class=cl>1    2  | 5   | --- massif tree line massif height index = 1
</span></span><span class=line><span class=cl>    / \ |/  \ |
</span></span><span class=line><span class=cl>   0   1|3   4| MMR INDICES
</span></span><span class=line><span class=cl>   -----|-----|
</span></span><span class=line><span class=cl>     0  |  1  | MASSIF
</span></span></code></pre></div><p>The layout of massif 1 in storage is</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+---++---+---+---+---+
</span></span><span class=line><span class=cl>| 2 || 3 | 4 | 5 | 6 |
</span></span><span class=line><span class=cl>+---++---+-------+---+
</span></span></code></pre></div><p>For massif <code>1</code>, the peak stack is <code>[2]</code>.
When node <code>4</code> was added, the &ldquo;back fill nodes&rdquo; were added to &ldquo;complete the tree&rdquo; and were also stored in massif <code>1</code>.
The &ldquo;break out&rdquo; nodes visually overhang the previous massif, but are stored in massif <code>1</code>.</p><p>This layout is also known as a &ldquo;post order&rdquo; traversal of a binary tree.</p><p>Note that the addition of node <code>6</code>, while backfilling for <code>4</code>, requires node <code>2</code> from the previous massif <code>0</code>.
This is why it is carried forward in the peak stack.</p><p>We can also see that is the <em>only</em> node that is required from massif <code>0</code> for <em>any</em> verification path in massif <code>1</code>.</p><p>As the log grows, the accumulator (peak stack) moves on.
However, historic verification paths can always be proven to exist in all future accumulators.
Given a pair of signed accumulators that are inconsistent, the broken log is evident.</p><p>The key point here is that, in massif <code>1</code>, when computing a verification path for nodes <code>3</code> or <code>4</code>, the only node that is required from massif <code>0</code> is available locally in the peak stack (in massif <code>1</code>).</p><p>This means that should you lose interest in the leaf entries from massif <code>0</code>, the whole massif can be deleted without fear that it will impact the verifiability of subsequent items in the log.</p><p>If you retain the seal from massif <code>0</code>, or if you can count on it being available from another trusted source, you only strictly need to retain leaves of interest and their verification paths.</p><h3 id=massif-2>Massif 2<a href=#massif-2 class=anchor aria-hidden=true>#</a></h3><p>The global tree at the end of massif <code>2</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2       6
</span></span><span class=line><span class=cl>          \
</span></span><span class=line><span class=cl>1    2  |  5  |  9  |
</span></span><span class=line><span class=cl>    / \ |/  \ | / \ |
</span></span><span class=line><span class=cl>   0   1|3   4|7   8|
</span></span><span class=line><span class=cl>   -----|-----|-----|
</span></span><span class=line><span class=cl>     0  |  1  |  2  | MASSIF
</span></span></code></pre></div><p>The layout for massif <code>2</code>, showing the peak stack is <code>[6]</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+---++---+---+---+
</span></span><span class=line><span class=cl>| 6 || 7 | 8 | 9 |
</span></span><span class=line><span class=cl>+---++---+-------+
</span></span></code></pre></div><p>Note that <code>6</code> has replaced <code>2</code>.
The <code>2</code> is not required for any verification path for elements added in massif <code>2</code> or beyond.</p><h3 id=massif-3>massif 3<a href=#massif-3 class=anchor aria-hidden=true>#</a></h3><p>The global tree at the end of massif <code>3</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>  3              14
</span></span><span class=line><span class=cl>                   \
</span></span><span class=line><span class=cl>                    \
</span></span><span class=line><span class=cl>                     \
</span></span><span class=line><span class=cl>  2        6         13
</span></span><span class=line><span class=cl>            \          \
</span></span><span class=line><span class=cl>  1    2  |  5  |  9  | 12  |
</span></span><span class=line><span class=cl>      / \ |/  \ | / \ | / \ |
</span></span><span class=line><span class=cl>     0   1|3   4|7   8|10 11|
</span></span><span class=line><span class=cl>     -----|-----|-----|-----|
</span></span><span class=line><span class=cl>     | 0  |  1  |  2  |  3  |
</span></span><span class=line><span class=cl>     -----|-----|-----|-----|
</span></span></code></pre></div><p>The peak stack is <code>[6, 9]</code>. Because both nodes <code>6</code> and <code>9</code> were needed to complete
the MMR that includes leaf node <code>11</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+---+---++----+----+----+----+----+
</span></span><span class=line><span class=cl>| 6 | 9 || 10 | 11 | 12 | 13 | 14 |
</span></span><span class=line><span class=cl>+---+---++----+----+----+----+----+
</span></span></code></pre></div><h3 id=massif-4>Massif 4<a href=#massif-4 class=anchor aria-hidden=true>#</a></h3><p>The global tree at the end of massif <code>4</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>  3              14
</span></span><span class=line><span class=cl>                   \
</span></span><span class=line><span class=cl>                    \
</span></span><span class=line><span class=cl>                     \
</span></span><span class=line><span class=cl>  2        6         13
</span></span><span class=line><span class=cl>            \          \
</span></span><span class=line><span class=cl>  1    2  |  5  |  9  | 12  |  17  |
</span></span><span class=line><span class=cl>      / \ |/  \ | / \ | / \ | /  \ |
</span></span><span class=line><span class=cl>     0   1|3   4|7   8|10 11|15  16|
</span></span><span class=line><span class=cl>     -----|-----|-----|-----|------|
</span></span><span class=line><span class=cl>     | 0  |  1  |  2  |  3  |   4  |
</span></span><span class=line><span class=cl>     -----|-----|-----|-----|------|
</span></span></code></pre></div><p>Note that this case is particularly interesting because it completes a full cycle from one perfect power-sized tree to the next.
A fact of the MMR construction is the look back is never further than the most recent &lsquo;perfect&rsquo; tree completing massif.</p><p>So the peak stack is <code>[14]</code>, discarding <code>6</code> and <code>9</code>, and the massif <code>4</code> layout is:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+---++----+----+----+
</span></span><span class=line><span class=cl>| 14|| 15 | 16 | 17 |
</span></span><span class=line><span class=cl>+---++----+----+----+
</span></span></code></pre></div><h2 id=takeaways>Takeaways<a href=#takeaways class=anchor aria-hidden=true>#</a></h2><ul><li>Merkle logs are divided into massifs, each of which stores verification data for a fixed number of your events.</li><li>Once verification data is written to the log, it never changes.</li><li>The &ldquo;look back&rdquo; nodes needed to make each massif self contained are deterministic and are filled in when a new massif is started.</li><li>The dynamically sized portions of the format are all computable, but we offer pre-calculated tables for convenience.</li><li><a href=https://github.com/datatrails/veracity/ target=_blank rel=noopener>Open-source tooling</a> exists in multiple languages for navigating the format.</li><li>Given a signed &ldquo;root&rdquo;, all entries in any copies of your log are irrefutably attested by DataTrails.</li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Merkle Mountain Ranges have seen extensive use in systems that need long term tamper evident storage, notably
<a href=https://zips.z.cash/zip-0221 target=_blank rel=noopener>zcash</a>,
<a href=https://github.com/mimblewimble/grin/blob/master/doc/mmr.md target=_blank rel=noopener>mimblewimble</a>, and
<a href=https://zips.z.cash/zip-0221#additional-reading target=_blank rel=noopener>many others</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>The <code>idtimestamp</code> value is 64 bits, of which the first 40 bits are a millisecond precision time value and the remainder is data used to guarantee uniqueness of the timestamp.
DataTrails uses a variant of the
<a href=https://en.wikipedia.org/wiki/Snowflake_ID target=_blank rel=noopener>Snowflake ID</a> scheme.
The DataTrails implementation can be found at
<a href=https://github.com/datatrails/go-datatrails-merklelog/blob/main/massifs/snowflakeid/nextid.go#L118 target=_blank rel=noopener>nextid.go</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>Such a path of hashes is commonly referred to as a &ldquo;proof&rdquo;, a &ldquo;witness&rdquo;, and an &ldquo;authentication path&rdquo;.
A Merkle Tree is sometimes referred to as authenticated data structures or a verifiable data structure. For the purposes of this article, there is no meaningful difference. They are all the same thing. We stick to &ldquo;verification&rdquo; and &ldquo;verifiable data structure&rdquo; in this article.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><p class=edit-page></p><div class="docs-navigation d-flex justify-content-between"><a href=https://docs.datatrails.ai/developers/developer-patterns/veracity/><div class="card my-1"><div class="card-body py-2">&larr; Independently verifying DataTrails transparent merkle logs</div></div></a><a class=ms-auto href=https://docs.datatrails.ai/developers/developer-patterns/massif-blob-offset-tables/><div class="card my-1"><div class="card-body py-2">Massif blob pre-calculated offsets &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div><div class="col-lg-8 order-first text-lg-end"><ul class=list-inline><li>Can't find what you're looking for? Search our <a href=https://support.datatrails.ai>Support Knowledgebase</a> or <a href=mailto:support@datatrails.ai>email Support</a></li></ul></div></div></div></footer><script src=https://docs.datatrails.ai/js/bootstrap.min.b4d48dd4d57c29a63a0ea5455b6d5b16f032e551e190ca88c04a0e5dd6b64b01657b3e1f44ff6e670ab72166686b0572f94c18d2f8d14c1a01aaf5f8e28fb345.js integrity="sha512-tNSN1NV8KaY6DqVFW21bFvAy5VHhkMqIwEoOXda2SwFlez4fRP9uZwq3IWZoawVy+UwY0vjRTBoBqvX44o+zRQ==" crossorigin=anonymous defer></script><script src=https://docs.datatrails.ai/js/highlight.min.3a4cb2619581c8c2a404737dff7063a4e54839fe2c53b904ffe261df02fe8da83fd12660ac8b0adbd432aa1b63fca6c49862e114f46cf2008058b9e29853d84b.js integrity="sha512-OkyyYZWByMKkBHN9/3BjpOVIOf4sU7kE/+Jh3wL+jag/0SZgrIsK29Qyqhtj/KbEmGLhFPRs8gCAWLnimFPYSw==" crossorigin=anonymous defer></script><script src=https://docs.datatrails.ai/main.min.5a11cd173e56732b0a703e2f8ecf68ea541e5db0cfb67389769e34602825b7b2517cd5043ac8da49638c3e5edbeb2706e035cf5a1ab50f79ddff45ab24f6122c.js integrity="sha512-WhHNFz5WcysKcD4vjs9o6lQeXbDPtnOJdp40YCglt7JRfNUEOsjaSWOMPl7b6ycG4DXPWhq1D3nd/0WrJPYSLA==" crossorigin=anonymous defer></script><script src=https://docs.datatrails.ai/index.min.c52129aeea03091b82c0de2b4d6eb12542e462cafbb6103d0f2a910e052925d7de303feedf32b94ed5c4e504659f42a102cb445bd5625534590ac41d1ea4ab3d.js integrity="sha512-xSEpruoDCRuCwN4rTW6xJULkYsr7thA9DyqRDgUpJdfeMD/u3zK5TtXE5QRln0KhAstEW9ViVTRZCsQdHqSrPQ==" crossorigin=anonymous defer></script></body></html>